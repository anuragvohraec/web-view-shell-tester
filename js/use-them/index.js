import{BlocBuilder as e,Bloc as t,BlocsProvider as i,MultiBlocsReactiveWidget as s}from"/js/bloc-them/index.js";import{html as o,nothing as r,render as a}from"/js/lit-html/lit-html.js";import{unsafeHTML as n}from"/js/lit-html/directives/unsafe-html.js";import{ifDefined as l}from"/js/lit-html/directives/if-defined.js";import{repeat as c}from"/js/lit-html/directives/repeat.js";import{unsafeSVG as h}from"/js/lit-html/directives/unsafe-svg.js";class d extends t{constructor(){super(void 0),this._name="LayThemBloc"}}class u extends e{constructor(){super("LayThemBloc",{blocs_map:{LayThemBloc:new d}});let e=this.getAttribute("in");e=e?e.toLowerCase():"column",this.lay_them_in=e;let t=this.getAttribute("ma");t=t?t.toLowerCase():"center",this.main_axis_alignment=t;let i=this.getAttribute("ca");i=i?i.toLowerCase():"stack"===e?"center":"stretch",this.cross_axis_alignment=i,this.overflow="auto";let s=this.getAttribute("overflow");s&&(this.overflow=s);let o=this.getAttribute("wrap");this._wrap=o?o.toLowerCase():"nowrap"}builder(e){return o`<style>.container{width:100%;height:100%;overflow:${this.overflow}}.flex{display:flex;flex-wrap:nowrap;height:100%;flex-direction:${(()=>"stack"==this.lay_them_in?"column":this.lay_them_in)()};justify-content:${this.main_axis_alignment};align-items:${this.cross_axis_alignment};flex-wrap:${this._wrap};height:100%;position:${(()=>"stack"==this.lay_them_in?"relative":"static")()}}.container::-webkit-scrollbar{display:none}${(()=>"stack"==this.lay_them_in?"::slotted(div){position: absolute;}":"")()}</style><div class="container"><div class="flex" id="flex"><slot></slot></div></div>`}}window.customElements.define("lay-them",u);class m{constructor(){this.path_tree={}}define(e){const t=e.split("/");for(;""===t[0];)t.shift();if(0==t.length)return void(this.path_tree.value="/");let i=this.path_tree,s=0;for(let o of t){const r=!o.startsWith(":");let a;r?a=i.plain:(a=i.parameterized,o=o.slice(1)),a||(r?(i.plain={},a=i.plain):(i.parameterized={},a=i.parameterized));const n=a[o],l=typeof(n&&n.value?n.value:n);if("string"===l&&s===t.length-1)return;if("undefined"===l){if(t.length-1===s)return void(a[o]={value:e});a[o]={},i=a[o]}else i=a[o];s++}}find(e){const t=e.split("/");for(;""===t[0];)t.shift();if(0==t.length)return this.path_tree.value?{path_params:{},matched_pattern:"/",parent_matches:[]}:void 0;let i=this.path_tree;if(i){let e={},s=[];return i.value&&s.push("/"),this._find(0,t,i,e,s)}}_find(e,t,i,s,o){let r=t[e],a=i.plain?i.plain[r]:void 0,n=a&&a.value?a.value:void 0;if(n)return"string"==typeof n?e===t.length-1?{path_params:s,matched_pattern:n,parent_matches:o}:(e++,o.push(n),this._find(e,t,a,s,o)):(e++,this._find(e,t,a,s,o));if(a)return e++,this._find(e,t,a,s,o);if(i.parameterized)for(let n of Object.keys(i.parameterized)){a=i.parameterized[n];let l=a&&a.value?a.value:void 0;if(s[n]=r,"string"==typeof l)return e===t.length-1?{path_params:s,matched_pattern:l,parent_matches:o}:(e++,o.push(l),this._find(e,t,a,s,o));{e++;let i=this._find(e,t,a,s,o);if(i)return i;s={},e--}}}}class p{static shadeColor(e,t,i="ff"){let s=parseInt(e.substring(1,3),16),o=parseInt(e.substring(3,5),16),r=parseInt(e.substring(5,7),16);return s=Math.floor(s*(100+t)/100),o=Math.floor(o*(100+t)/100),r=Math.floor(r*(100+t)/100),s=s<255?s:255,o=o<255?o:255,r=r<255?r:255,"#"+(1==s.toString(16).length?"0"+s.toString(16):s.toString(16))+(1==o.toString(16).length?"0"+o.toString(16):o.toString(16))+(1==r.toString(16).length?"0"+r.toString(16):r.toString(16))+i}}class g{static build_path(...e){return e.map(((e,t)=>0===t?e.trim().replace(/[\/]*$/g,""):e.trim().replace(/(^[\/]*|[\/]*$)/g,""))).filter((e=>e.length)).join("/")}static async compressAndResizeImage(e){try{const t={...{width:15,height:15,quality:.5,type:"image/webp"},...e},i=await createImageBitmap(t.file),s=g.resizeSizeMaintainingAspectRatio(i.width,i.height,t.max_length),o=new OffscreenCanvas(s.width,s.height),r=o.getContext("2d");if(r){r.drawImage(i,0,0,s.width,s.height);return o.convertToBlob({type:t.type,quality:t.quality})}throw"Cannot acquire 2d context for image compression!"}catch(e){throw console.error(e),e}}static resizeSizeMaintainingAspectRatio(e,t,i){return e>i||t>i?e>t?{width:i,height:Math.floor(t*i/e)}:{width:Math.floor(e*i/t),height:i}:{width:e,height:t}}static getVideoCover(e,t=0){return new Promise(((i,s)=>{const o=document.createElement("video");o.setAttribute("src",URL.createObjectURL(e)),o.load(),o.addEventListener("error",(e=>{s(e)})),o.addEventListener("loadedmetadata",(()=>{o.duration<t?s("video is too short."):(setTimeout((()=>{o.currentTime=t}),200),o.addEventListener("seeked",(()=>{const e=document.createElement("canvas");e.width=o.videoWidth,e.height=o.videoHeight;const t=e.getContext("2d");t.drawImage(o,0,0,e.width,e.height),t.canvas.toBlob((e=>{i(e)}),"image/jpeg",.75)})))}))}))}static formatBytes(e,t=2){if(0===e)return"0 Bytes";const i=t<0?0:t,s=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,s)).toFixed(i))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][s]}static covertToPlayTime(e){if(!e)return"0:0";if(e===1/0)return"Streaming...";e*=1e3;let t=Math.floor(e);const i=Math.floor(t/this.ONE_HOUR),s=t%this.ONE_HOUR,o=Math.floor(s/this.ONE_MINUTE),r=s%this.ONE_MINUTE,a=Math.floor(r/1e3);return`${i>0?`${i}:`:""}${("0"+o).slice(-2)}:${("0"+a).slice(-2)}`}}g.ONE_MINUTE=6e4,g.ONE_HOUR=60*g.ONE_MINUTE;class v{}v.PRESS_VIB=40,v.DRAG_VIB=30,v.IMAGE_EDIT_MID_RANGE=100,v.IMAGE_EDIT_ZOOM_SENSITIVITY=.05,v.IMAGE_EDIT_ZOOM_RESPONSE_TIME=200,v.IMAGE_EDIT_OP_DEFAULT_SIZE=800,v.PinchZoomBlocDoubleTapTime=500,v.IMAGE_RESIZE_SIZE_FILE_PICKER=1e3,v.IMAGE_RESIZE_QUALITY_FILE_PICKER=.8,v.PLAYER_INTERSECTION_RATIO_FOR_PLAY=1,v.PLAYER_INTERSECTION_RATIO_FOR_PAUSE=1;class _ extends t{constructor(){super({show:!1}),this._name="OverlayPageBloc"}hide(e){this.emit({show:!1,overlay_id:e})}}class b extends t{constructor(e){super(e)}}class f extends b{constructor(){super(0),this._name="BogusBloc"}}class y extends e{constructor(e,t){super(e,t);let i=document.useThemTheme;this._theme={...i,...this.useAttribute}}static get observedAttributes(){return["use"]}attributeChangedCallback(e,t,i){if("use"===e){const e=y.parseUseAttribute(i);this._theme={...this._theme,...e},this.bloc&&i&&this._build(this.bloc.state)}}get theme(){return this._theme}}class x extends y{constructor(){super("BogusBloc",{blocs_map:{BogusBloc:new f}})}}class w extends i{constructor(){super({})}}class k extends t{constructor(){super(""),this._name="UtRegistryBloc"}static add(e,t){this.registry[e]=t}static get(e){return this.registry[e]}static remove(e){delete this.registry[e]}}k.registry={};class B extends t{constructor(e=!0,t){super(e),this.overlay_id=t,this._name="HideBloc"}get data(){return this._data}set data(e){this._data=e}toggle(){var e,t;this.overlay_id?this.state?(this.emit(!1),null===(e=U.search("AppPageBloc",this.hostElement))||void 0===e||e.pushOverlayStack(this.overlay_id)):null===(t=U.search("AppPageBloc",this.hostElement))||void 0===t||t.popOutOfCurrentPage():this.emit(!this.state)}isHidden(){return this.state}isShowing(){return!this.state}show(){var e;this.overlay_id?this.state&&(this.emit(!1),null===(e=U.search("AppPageBloc",this.hostElement))||void 0===e||e.pushOverlayStack(this.overlay_id)):this.emit(!1)}hide(){var e;this.overlay_id?this.state||null===(e=U.search("AppPageBloc",this.hostElement))||void 0===e||e.popOutOfCurrentPage():this.emit(!0)}isTrue(){return this.state}ifNotTrue(){return!this.state}setTrue(){this.hide()}setFalse(){this.show()}onConnection(e){if(super.onConnection(e),this.overlay_id&&(this.overlayPageBloc=_.search("OverlayPageBloc",e),this.overlayPageBloc)){let e=e=>{e&&e.overlay_id===this.overlay_id&&!e.show&&(this.state||this.emit(!0))};e._ln_name=this._name,this.overlayPageBlocListenerId=this.overlayPageBloc._subscribe(e)}}onDisconnection(){this.overlay_id&&this.overlayPageBloc&&this.overlayPageBlocListenerId&&this.overlayPageBloc._unsubscribe(this.overlayPageBlocListenerId),super.onDisconnection()}}class T extends y{constructor(e){super(null!=e?e:"HideBloc")}builder(e){if(e&&this.hasAttribute("blank"))return o``;const t=e?"none":"block";return o`<style>.fullscreenGlass{position:fixed;width:100%;height:100%;background-color:${this.theme.dialogue_bg};display:${t};z-index:10;top:0;left:0;backdrop-filter:blur(4px)}</style><div class="fullscreenGlass" @click="${e=>(e.stopPropagation(),!1)}"><slot></slot></div>`}}customElements.define("ut-dialogue",T);class E extends t{constructor(e="white",t="#000000b3"){super(void 0),this.default_color=e,this.default_background_color=t,this._name="SnackBarBloc"}postMessage(e,t=4e3){e&&(this.emit({msg:e.msg,color:e.color||this.default_color,background_color:e.background_color||this.default_background_color}),this.current_timeout&&clearTimeout(this.current_timeout),this.current_timeout=setTimeout((()=>{this.emit(void 0)}),t))}}customElements.get("snack-bar")||customElements.define("snack-bar",class extends y{constructor(){super("SnackBarBloc")}connectedCallback(){super.connectedCallback(),setTimeout((()=>{this.i18nBloc||(this.i18nBloc=i.search("I18NBloc",this))}))}builder(e){let t=null==e?void 0:e.msg;if(this.i18nBloc&&(null==e?void 0:e.msg)){let i=this.i18nBloc.getText(null==e?void 0:e.msg);i&&(t=i)}return e?o`<style>.snack-bar{background-color:${e.background_color};padding:10px 20px;color:${e.color};border-radius:${this.theme.cornerRadius}}</style><div class="snack-bar"><div style="color:${e.color}">${t}</div></div>`:o``}});class I extends t{constructor(){super([]),this._max_file_picker=-1}get coverPic(){return this._coverPic}setCoverPic(e,t){this._coverPic=e,this.coverPicUrl&&(URL.revokeObjectURL(this.coverPicUrl),this.coverPicUrl=void 0),e?this.coverPicIsNotEditing=this.convertImage({id:"dummy",file:e,max_length:t,quality:90,type:"image/webp"}).then((e=>{e&&(this._coverPic=new File([e],"cover.webp",{type:"image/webp"}),this.coverPicUrl=URL.createObjectURL(this._coverPic),this.emit([...this.state]))})):this.emit([...this.state])}static initializeWorker(){let e=new Worker("/js/use-them/image-utils.js");return e.onmessage=e=>{this.resolvers[e.data.id](e.data.file),delete this.resolvers[e.data.id]},e}set max_file_picker(e){this._max_file_picker=e}get max_file_picker(){return this._max_file_picker}removeFile(e){var t;this.state[e]&&(null===(t=this.current_selected_files)||void 0===t||t.splice(e,1),this.state.splice(e,1),this.emit([...this.state]))}get selectedFiles(){return this.current_selected_files}moveUp(e){if(this.state&&this.state.length>0&&this.current_selected_files&&this.current_selected_files.length>0){let t=0;t=0===e?this.state.length-1:e-1;{let i=this.state[e];this.state[e]=this.state[t],this.state[t]=i}{let i=this.current_selected_files[e];this.current_selected_files[e]=this.current_selected_files[t],this.current_selected_files[t]=i,this.current_selected_files=[...this.current_selected_files]}this.emit([...this.state])}}moveDown(e){if(this.state&&this.state.length>0&&this.current_selected_files&&this.current_selected_files.length>0){let t=0;t=e===this.state.length-1?0:e+1;{let i=this.state[e];this.state[e]=this.state[t],this.state[t]=i}{let i=this.current_selected_files[e];this.current_selected_files[e]=this.current_selected_files[t],this.current_selected_files[t]=i,this.current_selected_files=[...this.current_selected_files]}this.emit([...this.state])}}async addFiles(e){let t=E.search("SnackBarBloc",this.hostElement);if(!t)throw"Please make sure to provide SnackBarBloc and snack-bar for this to work properly";if(!e.files)return t.postMessage({msg:"no_file_selected_msg"});const i=this._max_file_picker;if(e.files.length+this.state.length>i&&t.postMessage({msg:`Max: ${i} files only!`}),this.revokeAllObjectURL(),e.files.length>0){const t=Array.from(e.files);this.current_selected_files||(this.current_selected_files=[]),this.current_selected_files=this.current_selected_files.concat(t),this.emit(this.current_selected_files.slice(0,i).map((e=>({name:e.name,url:URL.createObjectURL(e),mime:e.type,size:e.size}))))}}async fileSelected(e){this.revokeAllObjectURL();const t=E.search("SnackBarBloc",e);if(!t)throw"Please make sure to provide SnackBarBloc and snack-bar for this to work properly";if(!e.files)return t.postMessage({msg:"no_file_selected_msg"});const i=this._max_file_picker;if(e.files.length>i&&t.postMessage({msg:`Max: ${i} files only!`}),0===e.files.length)this.current_selected_files=[],this.emit([]);else{const t=Array.from(e.files);this.current_selected_files=t,this.emit(this.current_selected_files.slice(0,i).map((e=>({name:e.name,url:URL.createObjectURL(e),mime:e.type,size:e.size}))))}}convertImage(e){I.count++;const t=I.count;return e.id=t,new Promise((i=>{I.resolvers[t]=i,I.worker.postMessage(e)}))}async createImageHash(e){return await this.convertImage({id:"dummy",file:e,max_length:15,quality:.5,type:"image/webp"})}async createVideoHash(e){return await g.compressAndResizeImage({file:e,max_length:15,quality:.5,type:"image/webp",id:"1"})}async upOnFileSelectionNoSimulationProcessing(e,t){}async simulateFasterProcessing(e){return"dummy"}async cleanUpAfterProcessing(e){}async postFileMessage(e,t,i=!1){var s;let o=E.search("SnackBarBloc",this.hostElement);if(!(null===(s=this.current_selected_files)||void 0===s?void 0:s.length))return null==o?void 0:o.postMessage({msg:"no_file_selected_msg"});await this.coverPicIsNotEditing;const r=this.coverPic;(async(e,i,s)=>{let o=await this._processFilePicked(t,i);await this.upOnFileSelection(o,e,s),await this.cleanUpAfterProcessing(e)})(await this.simulateFasterProcessing(e),this.selectedFiles,r),this.current_selected_files=void 0,this.emit([]),i||this.closeFilePicker(e)}async postFileMessageAndReturnValue({context:e,picker_type:t,doNotCloseFilePicker:i=!1,data:s}){if(e.files){let o=await this._processFilePicked(t,Array.from(e.files)),r=await this.upOnFileSelectionNoSimulationProcessing(o,s);return i||this.closeFilePicker(e),r}}async _processFilePicked(e,t){if(!this.getBloc("SnackBarBloc"))throw"Please make sure to provide SnackBarBloc and snack-bar for this to work properly";let i=[];if(t){let s=!1;for(let o of t){let t,r;switch(e){case C.IMAGE:if("image/gif"===o.type)t=o;else{let e=o.name,i=await this.convertImage({id:"dummy",file:o,max_length:v.IMAGE_RESIZE_SIZE_FILE_PICKER,quality:v.IMAGE_RESIZE_QUALITY_FILE_PICKER,type:"image/webp"});t=new File([i],e,{type:"image/webp"})}r=await this.createImageHash(o);break;case C.VIDEO:t=o,r=await this.createVideoHash(await g.getVideoCover(o));break;case C.AUDIO:case C.FILE:t=o,s=!0;break;default:throw"Not defined yet"}let a={fileBlob:t,file_name:o.name};if(!s){const e=await new Promise((e=>{const t=new FileReader;t.onloadend=()=>{let i=new Uint8Array(t.result);e(i)},t.readAsArrayBuffer(r)}));let t=Array.from(e);a.fileHash=t,a.fileHashBlob=r}i.push(a)}}return i}closeFilePicker(e){const t=U.search("AppPageBloc",e);null==t||t.popOutOfCurrentPage()}revokeAllObjectURL(){if(this.state&&this.state.length>0)for(let e of this.state)URL.revokeObjectURL(e.url);this.coverPicUrl&&(URL.revokeObjectURL(this.coverPicUrl),this.coverPicUrl=void 0)}}I.count=0,I.resolvers={},I.worker=I.initializeWorker();class $ extends y{constructor(){super("HideBloc",{blocs_map:{HideBloc:new B}})}builder(e){return e?o`<div><slot></slot></div>`:o`<lay-them ma="center" ca="center" overflow="hide"><circular-progress-indicator></circular-progress-indicator></lay-them>`}}customElements.get("image-picker-confirmation-box-container")||customElements.define("image-picker-confirmation-box-container",$);class P extends i{builder(){return o`<div style="background-color:#00000026;padding:10px;padding-bottom:30px"><lay-them in="column" ca="center"><div><ut-icon icon="insert-drive-file"></ut-icon></div><div style="word-break:break-word;font-family:monospace;font-size:.8em;padding-top:5px;text-align:center"><div style="user-select:none">${this._uInfo.ext}(${g.formatBytes(this._uInfo.size)})</div><div>${this._uInfo.name}</div></div></lay-them></div>`}set info_abt_file(e){this._uInfo=e,this._build()}}var C,S,A,O,R,D,M;customElements.get("ut-picked-file-widget")||customElements.define("ut-picked-file-widget",P),function(e){e[e.IMAGE=0]="IMAGE",e[e.VIDEO=1]="VIDEO",e[e.AUDIO=2]="AUDIO",e[e.FILE=3]="FILE"}(C||(C={}));class N extends t{constructor(){super(0),this._name="FilePickerExternalTriggers",this.filePickerRegistry={}}register(e){this.filePickerRegistry[e.tagName.toLowerCase()]=e}openFilePicker(e,t,i){var s;null===(s=U.search("AppPageBloc",this.hostElement))||void 0===s||s.goToPage(t,i),setTimeout((()=>{var t;null===(t=this.filePickerRegistry[e.toLowerCase()])||void 0===t||t.openFilePickerExternally()}),300)}}class z extends y{constructor(e){super(e.bloc_name,e.bloc_config),this.config=e,this.fileChanged=e=>{var t,i;const s=e.target;"file-upload"===s.id?null===(t=this.bloc)||void 0===t||t.fileSelected(s):"file-add"==s.id&&(null===(i=this.bloc)||void 0===i||i.addFiles(s))},this.openFilePickerExternally=()=>{var e;(null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector("backable-screen > lay-them > div.options > image-picker-confirmation-box-container > lay-them > div:nth-child(1) > label")).click()},this.removeIndex=e=>{var t,i;const s=e.currentTarget,o=parseInt(null!==(t=s.getAttribute("i"))&&void 0!==t?t:"0");null===(i=this.bloc)||void 0===i||i.removeFile(o)},this.editCoverPic=e=>{var t;const i=e.currentTarget,s=parseInt(i.getAttribute("size"));if(null===(t=this.bloc)||void 0===t?void 0:t.coverPic){const e=k.get("ImageEditorHideBloc");let t="cover.webp";e.editImage({index:0,fileName:t,blob:this.bloc.coverPic,imageEditedListener:(e,i)=>{var o;null===(o=this.bloc)||void 0===o||o.setCoverPic(new File([e],t,{type:"image/webp"}),s)}}),e.toggle()}},this.editIndex=e=>{var t,i,s,o;const r=e.currentTarget,a=parseInt(null!==(t=r.getAttribute("i"))&&void 0!==t?t:"0");null===(i=this.shadowRoot)||void 0===i||i.querySelector("ut-image-editor");{const e=k.get("ImageEditorHideBloc");if(e&&(null===(o=null===(s=this.bloc)||void 0===s?void 0:s.selectedFiles)||void 0===o?void 0:o[a])){const t=this.bloc.selectedFiles[a].name;e.editImage({index:a,fileName:t,blob:this.bloc.selectedFiles[a],imageEditedListener:(e,i)=>{var s;(null===(s=this.bloc)||void 0===s?void 0:s.selectedFiles)&&(this.bloc.selectedFiles[a]=new File([e],t,{type:"image/webp"}),this.bloc.emit(this.bloc.selectedFiles.slice(0,this.config.max_file).map((e=>({name:e.name,url:URL.createObjectURL(e),mime:e.type,size:e.size})))))}}),e.toggle()}}},this.moveUp=e=>{var t,i;const s=e.currentTarget,o=parseInt(null!==(t=s.getAttribute("i"))&&void 0!==t?t:"0");null===(i=this.bloc)||void 0===i||i.moveUp(o)},this.moveDown=e=>{var t,i;const s=e.currentTarget,o=parseInt(null!==(t=s.getAttribute("i"))&&void 0!==t?t:"0");null===(i=this.bloc)||void 0===i||i.moveDown(o)},this.selectedACoverPic=e=>{var t,i;let s=e.currentTarget;this.bloc&&this.bloc.setCoverPic(null!==(i=null===(t=null==s?void 0:s.files)||void 0===t?void 0:t[0])&&void 0!==i?i:void 0,this.picker_config.coverPicSizeInPX)},this.picker_config={accept:"*/*",type:C.FILE,coverPicSizeInPX:300},e.picker_config&&(this.picker_config={...this.picker_config,...e.picker_config})}connectedCallback(){super.connectedCallback(),this.bloc&&(this.bloc.max_file_picker=this.config.max_file,this.bloc.revokeAllObjectURL(),this.bloc.emit([])),setTimeout((()=>{var e;null===(e=N.search("FilePickerExternalTriggers",this))||void 0===e||e.register(this)}),200)}disconnectedCallback(){var e;null===(e=this.bloc)||void 0===e||e.revokeAllObjectURL(),super.disconnectedCallback()}builder(e){var t,i,s;let a="attach";return this.title&&this.title.trim().length>0&&(a=this.title),o`<style>.options{padding:10px}input[type=file]{display:none}.image_grid{display:flex;gap:20px;align-items:center;justify-items:center;grid-template-columns:auto auto;justify-content:center;flex-wrap:wrap}.image_item{width:300px;height:300px;text-align:center}.video_item{width:90vw}.edit-button{width:50px;height:50px}.addCoverButton{position:fixed;top:10px;right:10px;z-index:3}</style><backable-screen title="${a}"><lay-them in="column" ca="stretch" ma="space-between"><div style="flex-grow:1;height:0;overflow-y:auto;padding:10px">${0===e.length?o`<lay-them ma="center" ca="center"><ut-p>no_file_selected</ut-p></lay-them>`:o`<div class="image_grid">${(null===(t=this.bloc)||void 0===t?void 0:t.coverPicUrl)?o`<lay-them in="stack"><img class="image_item" src="${this.bloc.coverPicUrl}"><div style="bottom:0;width:100%;height:50px;background-color:#00000094"><lay-them in="row" ma="space-between" ma="center"><div class="edit-button" @click="${this.editCoverPic}" size="${this.picker_config.coverPicSizeInPX}"><ink-well><ut-icon icon="edit" use="icon_inactive:white;"></ut-icon></ink-well></div><div class="edit-button" @click="${this.selectedACoverPic}"><ink-well><ut-icon icon="clear" use="icon_inactive:white;"></ut-icon></ink-well></div></lay-them></div></lay-them>`:r} ${c(e,(e=>e.name),((e,t)=>o`<style>.arrangeIcon{width:50px;height:50px;background-color:#00000094;overflow:hidden}</style><lay-them in="column" ma="center"><div>${(()=>{var i;switch(null===(i=this.config.picker_config)||void 0===i?void 0:i.type){case C.VIDEO:return o`<video controls class="video_item" src="${e.url}"></video>`;case C.AUDIO:return o`<audio controls class="video_item" src="${e.url}"></audio>`;case C.FILE:return o`<ut-picked-file-widget .info_abt_file="${{size:e.size,ext:e.mime,name:e.name}}"></ut-picked-file-widget>`;default:return o`<lay-them in="stack"><div style="top:0;width:100%;height:50px;display:flex;align-items:center;justify-content:space-between"><div class="arrangeIcon" i="${t}" @click="${this.moveUp}"><ink-well><ut-icon icon="chevron-up" use="icon_inactive:white;"></ut-icon></ink-well></div><div class="arrangeIcon" i="${t}" @click="${this.moveDown}"><ink-well><ut-icon icon="chevron-down" use="icon_inactive:white;"></ut-icon></ink-well></div></div><img class="image_item" src="${e.url}"><div style="bottom:0;width:100%;height:50px;background-color:#00000094"><lay-them in="row" ma="space-between" ma="center"><div class="edit-button" @click="${this.editIndex}" i="${t}"><ink-well><ut-icon icon="edit" use="icon_inactive:white;"></ut-icon></ink-well></div><div class="edit-button" @click="${this.removeIndex}" i="${t}"><ink-well><ut-icon icon="clear" use="icon_inactive:white;"></ut-icon></ink-well></div></lay-them></div></lay-them>`}})()}</div><div style="font-family:monospace;word-break:break-word;min-width:30vw"><ut-h5>${e.name}</ut-h5></div></lay-them>`))}</div>`}</div><div class="options"><image-picker-confirmation-box-container><lay-them in="row" ma="space-around"><div><label for="file-upload"><circular-icon-button use="icon:attach-file"></circular-icon-button></label> <input id="file-upload" type="file" @change="${this.fileChanged}" multiple="multiple" accept="${null!==(i=this.picker_config.accept)&&void 0!==i?i:"*/*"}" capture="${l(this.picker_config.capture)}"></div><div><label for="file-add"><circular-icon-button use="icon:add"></circular-icon-button></label> <input id="file-add" type="file" @change="${this.fileChanged}" multiple="multiple" accept="${null!==(s=this.picker_config.accept)&&void 0!==s?s:"*/*"}" capture="${l(this.picker_config.capture)}"></div><div><circular-icon-button use="icon:done;" @click="${e=>{var t;null===(t=this.bloc)||void 0===t||t.postFileMessage(e.currentTarget,this.picker_config.type)}}"></circular-icon-button></div><div><circular-icon-button use="icon:clear;" @click="${e=>{var t;null===(t=this.bloc)||void 0===t||t.closeFilePicker(e.currentTarget)}}"></circular-icon-button></div></lay-them></image-picker-confirmation-box-container></div></lay-them>${this.picker_config.type!==C.IMAGE&&this.picker_config.coverPicSizeInPX?o`<label for="cover-pic"><div class="addCoverButton"><labeled-icon-button icon="add" label="cover" use="color:white;"></labeled-icon-button></div><input id="cover-pic" type="file" accept="image/*" @change="${this.selectedACoverPic}"></label>`:r}</backable-screen>`}}customElements.define("ut-file-picker-editor",class extends x{builder(e){var t;return o`<div style="width:100%;height:100%"><slot></slot></div><ut-image-editor iesize="${null!==(t=this.getAttribute("iesize"))&&void 0!==t?t:"800px"}"></ut-image-editor>`}});class L extends t{constructor(){super(0),this._name="RouteThemNavigationHookBloc"}}class F extends t{constructor(e=!1,t=F.INIT_STATE){if(super(t),this.save_history=e,this.initState=t,this._name="RouteThemBloc",this._compass=new m,this._navHooksBlocSearchedOnce=!1,this._compass.define("/"),this.save_history){if(this._init_path=document.location.pathname,window.onpopstate){throw`An app should have only one router which can control history. Some where in your code <${window.onpopstate.bloc_name}> window.onpopstate function is already registered. And you are retrying again this in bloc ${this.name}!`}let e=e=>{var t,i,s,o,r,a;try{let n=e.state;if(n||(n=this.initState),(null===(t=this.state.data)||void 0===t?void 0:t.overlay_id)&&(this.popOverlayStack(this.state.data.overlay_id),delete this.state.data.overlay_id),null===(s=null===(i=this.state)||void 0===i?void 0:i.data)||void 0===s?void 0:s.confirmation_message){if(!confirm(null===(r=null===(o=this.state)||void 0===o?void 0:o.data)||void 0===r?void 0:r.confirmation_message)){let e=this.state.url_path;return void history.pushState(this.state,this._convertUrlToPath(e),g.build_path(window.location.origin,this._init_path,e))}}let l={...n};return this.emit(l),null===(a=this.navHooks)||void 0===a?void 0:a.onPopHook(this.save_history,this.hostElement,l)}finally{navigator.vibrate(v.PRESS_VIB)}};window.onpopstate=e}}get navHooks(){return this._navHooksBlocSearchedOnce||this._navHooks||!this.hostElement||(this._navHooks=L.search("RouteThemNavigationHookBloc",this.hostElement),this._navHooksBlocSearchedOnce=!0),this._navHooks}define(e){this._compass.define(e)}popOutOfCurrentPage(){navigator.vibrate(v.PRESS_VIB),history.back()}_convertUrlToPath(e){return e.split("/").join("-").toUpperCase().substring(1)}goToPage(e,t){var i;try{let s=this._compass.find(e);if(s){let o={url_path:e,pathDirection:s,data:t};if(this.emit(o),this.save_history){let t=this._convertUrlToPath(e);history.pushState(o,t,g.build_path(window.location.origin,this._init_path,e))}null===(i=this.navHooks)||void 0===i||i.onGoToPageHook(this.save_history,this.hostElement,o)}else console.log(`No route exists for path: ${e}`)}finally{navigator.vibrate(v.PRESS_VIB)}}pushOverlayStack(e,t=!1){let i=this.state.url_path,s=this.state;s||(s=this.initState),s.data||(s.data={}),t&&(s.data={}),s.data.overlay_id=e;let o=this._convertUrlToPath(i);history.pushState(s,o,g.build_path(window.location.origin,this._init_path,i)),this.emit(s)}popOverlayStack(e){var t,i,s;null===(t=_.search("OverlayPageBloc",this.hostElement))||void 0===t||t.hide(e),(null===(s=null===(i=this.state)||void 0===i?void 0:i.data)||void 0===s?void 0:s.overlay_id)&&delete this.state.data.overlay_id}_goToPageDoNotSaveHistory(e,t){let i=this._compass.find(e);if(i){let s={url_path:e,pathDirection:i,data:t};this.emit(s)}else console.log(`No route exists for path: ${e}`)}get savesToHistory(){return this.save_history}}F.INIT_STATE={url_path:"/",pathDirection:{path_params:{},matched_pattern:"/",parent_matches:[]},data:{}};class V extends i{constructor(){super({RouteThemBloc:new F})}builder(){return o`<div style="width:100%;height:100%"><slot></slot></div>`}}class H extends e{constructor(e="a-page",t="RouteThemBloc"){super("BogusBloc",{blocs_map:{BogusBloc:new f}}),this.pageTagName=e,this.routeBlocName=t}connectedCallback(){var e;super.connectedCallback();let t=F.search(this.routeBlocName,this);if(this.querySelectorAll(this.pageTagName).forEach((e=>{let i=e.getAttribute("route");if(!i)throw"No route defined for a page";null==t||t.define(i)})),null==t?void 0:t.savesToHistory){const i=window.location.hash;i&&(null==t||t._goToPageDoNotSaveHistory("/"+i,null===(e=null===history||void 0===history?void 0:history.state)||void 0===e?void 0:e.data))}}builder(e){return o`<div style="width:100%;height:100%"><slot></slot></div>`}}class G extends e{constructor(e="RouteThemBloc"){super(e),this.behavior="hide",this.initInnerHTML=this.innerHTML;let t=this.getAttribute("behaves");t&&(t=t.toLowerCase(),this.behavior=t)}get route(){let e=this.getAttribute("route");if(e)return e;throw"No route defined for a page"}toBeHidden(e){return e.pathDirection.matched_pattern!==this.route}builder(e){let t=this.toBeHidden(e);switch(this.behavior){case"hide":default:return this._getBaseTemplate(t);case"reload":return o`${t?o`<div></div>`:this._getHtmlWithInnerContent()}`}}_getHtmlWithInnerContent(){this.innerHTML="";return o`<div style="width:100%;height:100%">${n(this.initInnerHTML)}</div>`}_getBaseTemplate(e){return o`<style>.hide{display:none}.show{display:block}</style><div class="${e?"hide":"show"}" style="width:100%;height:100%"><slot></slot></div>`}}customElements.get("route-them-controller")||customElements.define("route-them-controller",V),customElements.get("route-them")||customElements.define("route-them",H),customElements.get("a-page")||customElements.define("a-page",G);class U extends F{constructor(){super(!0),this._name="AppPageBloc"}}class W extends i{constructor(){super({AppPageBloc:new U,OverlayPageBloc:new _,FilePickerExternalTriggers:new N})}builder(){return o`<div style="width:100%;height:100%"><slot></slot></div>`}}customElements.get("app-pages-controller")||customElements.define("app-pages-controller",W);class j extends G{constructor(){super("AppPageBloc")}}customElements.get("app-page")||customElements.define("app-page",j);class Y extends H{constructor(){super("app-page","AppPageBloc")}}customElements.get("app-pages-container")||customElements.define("app-pages-container",Y);class q{constructor(){this.primaryColor="#ff2052",this.secondaryColor="#4e00ec",this.iconColor="#ffffff",this.backgroundColor="#ededed",this.cornerRadius="4px",this.input_bg_color="#e6e6e6",this.input_height="40px",this.input_padding="5px 10px",this.input_cursor_color="#ffffff",this.input_text_color="#000000",this.input_place_holder_color="#808080",this.input_icon_color="#a7a7a7",this.input_font_weight="normal",this.input_checkbox_active_color=this.primaryColor,this.input_check_mark_color=this.input_bg_color,this.input_checkbox_hover=this.input_bg_color,this.input_radio_button_active_color=this.primaryColor,this.button_disable_color="#0000008c",this.button_height="40px",this.snack_bar_bg="#000000b3",this.glass_black="#0000008c",this.dialogue_bg=this.glass_black,this.P_font_size="1em",this.H3_font_size="1.1em",this.H2_font_size="1.2em",this.H1_font_size="1.5em",this.H5_font_size="0.8em",this.H6_font_size="0.6em",this.color="black",this.tab_inactive_color="#dbdbdb",this.tab_inactive_icon_color="#919191",this.tab_active_icon_color=this.primaryColor,this.tab_header_margin="inherit",this.tab_header_border_radius="inherit",this.tab_header_overflow="inherit",this.tab_header_shadow="none",this.tab_header_zIndex="inherit",this.tab_header_bar_shadow="none",this.tab_header_height="50px",this.tab_header_padding="0px",this.selector_item_selection_color=this.primaryColor,this.icon_active=this.primaryColor,this.icon_inactive="#919191",this.icon_size="20px",this.vTab_inactiveColor="#dbdbdb",this.vTab_activeColor="transparent",this.vTab_active_icon_color=this.primaryColor,this.vTab_inactive_icon_color="#919191",this.scaffold_menu_icon_color="#fff",this.scaffold_title_background_shadow="0px 0px 4px black",this.scaffold_title_bar_default_background_display="block",this.scaffold_menu_glass_color=this.glass_black,this.scaffold_menu_shadow="0px 0px 30px black",this.scaffold_title_bar_border_radius="0px",this.confirmation_dialogue_title_bar_image="inherit",this.confirmation_dialogue_border_radius=this.cornerRadius,this.toggleButtonOnColor=this.primaryColor}}class Z extends t{constructor(e){super(e),this._name="ThemeBloc"}changeTheme(e){this.emit(e)}}class X extends i{constructor(e){super({ThemeBloc:new Z(e)}),document.useThemTheme=e}builder(){return o`<div style="width:100%;height:100%"><slot></slot></div>`}}class Q extends t{constructor(){super(0),this._name="ProgressBloc",this._completed=!1}get completed(){return this._completed}updateProgress(e){let t=7.8*e;this._completed||(t>=780?this.markAsComplete():this.emit(t))}markAsComplete(){this.emit(780),this._completed=!0}reset(){this.emit(0),this._completed=!1}}class K extends y{constructor(e){super(e)}builder(e){return o`<svg style="height:4px;width:100%" inkscape:version="1.0.1 (0767f8302a, 2020-10-17)" sodipodi:docname="progress-bar.svg" version="1.1" viewBox="0 0 800 50" xmlns="http://www.w3.org/2000/svg" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" preserveAspectRatio="none"><linearGradient id="linearGradient850" x1="0" x2="500" y1="53.936" y2="50.846" gradientUnits="userSpaceOnUse"><stop stop-color="${this.theme.secondaryColor}" offset="0"></stop><stop stop-color="${this.theme.primaryColor}" offset="1"></stop></linearGradient><g inkscape:groupmode="layer" inkscape:label="Layer 1"><g id="progress-bar" stroke-linejoin="round" stroke-opacity=".65882" stroke-width="1.9238"><rect id="base" x="10" y="10" width="780" height="30" fill="${this.theme.backgroundColor}" rx="${this.theme.cornerRadius}"/><rect id="progress" x="10" y="10" width="${e}" height="30" fill="url(#linearGradient850)" rx="${this.theme.cornerRadius}"/></g></g></svg>`}}class J extends y{constructor(e,t){super(t,{blocs_map:(()=>{let i={};return i[t]=e,i})()})}builder(e){return o`<svg style="height:4px;width:100%" inkscape:version="1.0.1 (0767f8302a, 2020-10-17)" sodipodi:docname="progress-bar.svg" version="1.1" viewBox="0 0 800 50" xmlns="http://www.w3.org/2000/svg" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" preserveAspectRatio="none"><linearGradient id="linearGradient850" x1="0" x2="500" y1="53.936" y2="50.846" gradientUnits="userSpaceOnUse"><stop stop-color="${this.theme.secondaryColor}" offset="0"></stop><stop stop-color="${this.theme.primaryColor}" offset="1"></stop></linearGradient><g inkscape:groupmode="layer" inkscape:label="Layer 1"><g id="progress-bar" stroke-linejoin="round" stroke-opacity=".65882" stroke-width="1.9238"><rect id="base" x="10" y="10" width="780" height="30" fill="${this.theme.backgroundColor}" rx="${this.theme.cornerRadius}"/><rect id="progress" x="10" y="10" width="${e}" height="30" fill="url(#linearGradient850)" rx="${this.theme.cornerRadius}"/></g></g></svg>`}}class ee extends x{builder(e){return o`<style>.pure-material-progress-circular{-webkit-appearance:none;-moz-appearance:none;appearance:none;box-sizing:border-box;border:none;border-radius:50%;padding:.25em;width:3em;height:3em;color:${this.theme.primaryColor};background-color:transparent;font-size:16px;overflow:hidden}.pure-material-progress-circular::-webkit-progress-bar{background-color:transparent}.pure-material-progress-circular:indeterminate{-webkit-mask-image:linear-gradient(transparent 50%,#000 50%),linear-gradient(to right,transparent 50%,#000 50%);mask-image:linear-gradient(transparent 50%,#000 50%),linear-gradient(to right,transparent 50%,#000 50%);animation:pure-material-progress-circular 6s infinite cubic-bezier(.3,.6,1,1)}.pure-material-progress-circular:indeterminate,:-ms-lang(x){animation:none}.pure-material-progress-circular:indeterminate::-webkit-progress-value,.pure-material-progress-circular:indeterminate::before{content:"";display:block;box-sizing:border-box;margin-bottom:.25em;border:solid .25em transparent;border-top-color:currentColor;border-radius:50%;width:100%!important;height:100%;background-color:transparent;animation:pure-material-progress-circular-pseudo .75s infinite linear alternate}.pure-material-progress-circular:indeterminate::-moz-progress-bar{box-sizing:border-box;border:solid .25em transparent;border-top-color:currentColor;border-radius:50%;width:100%;height:100%;background-color:transparent;animation:pure-material-progress-circular-pseudo .75s infinite linear alternate}.pure-material-progress-circular:indeterminate::-ms-fill{animation-name:-ms-ring}@keyframes pure-material-progress-circular{0%{transform:rotate(0)}12.5%{transform:rotate(180deg);animation-timing-function:linear}25%{transform:rotate(630deg)}37.5%{transform:rotate(810deg);animation-timing-function:linear}50%{transform:rotate(1260deg)}62.5%{transform:rotate(1440deg);animation-timing-function:linear}75%{transform:rotate(1890deg)}87.5%{transform:rotate(2070deg);animation-timing-function:linear}100%{transform:rotate(2520deg)}}@keyframes pure-material-progress-circular-pseudo{0%{transform:rotate(-30deg)}29.4%{border-left-color:transparent}29.41%{border-left-color:currentColor}64.7%{border-bottom-color:transparent}64.71%{border-bottom-color:currentColor}100%{border-left-color:currentColor;border-bottom-color:currentColor;transform:rotate(225deg)}}</style><lay-them ma="center" ca="center" overflow="hidden"><progress class="pure-material-progress-circular"></progress></lay-them>`}}customElements.get("circular-progress-indicator")||customElements.define("circular-progress-indicator",ee);class te extends x{builder(e){return o`<style>.load-wraper{height:100%;width:100%;overflow:hidden}.activity{position:relative;left:-45%;height:100%;width:45%;background-image:linear-gradient(to left,#fbfbfb0d,#fbfbfb4d,#fbfbfb99,#fbfbfb4d,#fbfbfb0d);animation:loading 1s infinite}@keyframes loading{0%{left:-45%}100%{left:100%}}</style><div class="load-wraper"><div class="activity"></div></div>`}}customElements.get("loading-cell")||customElements.define("loading-cell",te);class ie extends x{builder(e){return o`<style>.progress-line,.progress-line:before{height:3px;width:100%;margin:0}.progress-line{background-color:${this.theme.primaryColor};display:-webkit-flex;display:flex}.progress-line:before{background-color:${this.theme.secondaryColor};content:'';-webkit-animation:running-progress 2s cubic-bezier(.4,0,.2,1) infinite;animation:running-progress 2s cubic-bezier(.4,0,.2,1) infinite}@-webkit-keyframes running-progress{0%{margin-left:0;margin-right:100%}50%{margin-left:25%;margin-right:0}100%{margin-left:100%;margin-right:0}}@keyframes running-progress{0%{margin-left:0;margin-right:100%}50%{margin-left:25%;margin-right:0}100%{margin-left:100%;margin-right:0}}</style><div class="progress-line"></div>`}}customElements.get("ut-indeterminate-loading-bar")||customElements.define("ut-indeterminate-loading-bar",ie);class se extends t{constructor(){super({showMenu:!1,showSnackbar:!1}),this._name="ScaffoldBloc"}onConnection(e){if(super.onConnection(e),this.overlayPageBloc=_.search("OverlayPageBloc",e),this.overlayPageBloc&&!this.overlayPageBlocListenerId){let e=e=>{e&&e.overlay_id===this._name&&!e.show&&this.state.showMenu&&this.hideMenu()};e._ln_name=this._name,this.overlayPageBlocListenerId=this.overlayPageBloc._subscribe(e)}}onDisconnection(){this.overlayPageBloc&&this.overlayPageBlocListenerId&&this.overlayPageBloc._unsubscribe(this.overlayPageBlocListenerId),super.onDisconnection()}hideMenu(){this.emit({...this.state,showMenu:!1})}toggleMenu(e=!0){navigator.vibrate(v.PRESS_VIB);let t={...this.state};t.showMenu=!t.showMenu;const i=U.search("AppPageBloc",this.hostElement);t.showMenu&&e?null==i||i.pushOverlayStack(this._name,!0):!t.showMenu&&e&&(null==i||i.popOutOfCurrentPage()),this.emit(t)}postMessageToSnackBar(e,t=4e3){let i={...this.state};i.showSnackbar=!0,i.snackBarMessage=e,this.emit(i),setTimeout((()=>{let e={...this.state};e.showSnackbar=!1,e.snackBarMessage=void 0,this.emit(e)}),t)}}class oe extends y{constructor(){super("ScaffoldBloc",{blocs_map:{ScaffoldBloc:new se}}),this.toggleMenuBar=()=>{var e;null===(e=U.search("AppPageBloc",this))||void 0===e||e.popOutOfCurrentPage()}}builder(e){return o`<style>.appbar{min-height:60px;width:100%;z-index:10}.expanded{width:100%;height:100%}.glass{background-color:${this.theme.scaffold_menu_glass_color}}.snack-bar{background-color:${this.theme.snack_bar_bg};position:fixed;bottom:50px;padding:10px 20px;max-width:90%;color:#fff}</style><div class="expanded"><lay-them in="stack"><div class="expanded"><lay-them for="base of scaffold"><div class="appbar"><lay-them in="stack"><div style="height:60px;position:fixed;width:100%;box-shadow:${this.theme.scaffold_title_background_shadow};border-radius:${this.theme.scaffold_title_bar_border_radius};overflow:hidden"><slot name="appbar-bg"><svg style="display:${this.theme.scaffold_title_bar_default_background_display}" version="1.1" viewBox="0 0 100 100" preserveAspectRatio="none" height="100%" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><linearGradient id="linearGradient850" x1="-28.773" x2="119.68" y1="53.936" y2="50.846" gradientUnits="userSpaceOnUse"><stop stop-color="${this.theme.secondaryColor}" offset="0"></stop><stop stop-color="${this.theme.primaryColor}" offset="1"></stop></linearGradient></defs><rect width="100" height="100" fill="url(#linearGradient850)" stroke-linejoin="round" stroke-width="2.1354"></rect></svg></slot></div><div style="width:100%;height:60px"><lay-them in="row" ma="flex-start" ca="stretch"><div style="width:50px"><lay-them ma="center" ca="center"><ut-scaffold-menu-button></ut-scaffold-menu-button></lay-them></div><div style="flex:1"><slot name="title"></slot></div></lay-them></div></lay-them></div><div class="body" style="flex:1 1 auto;overflow-y:auto"><slot name="body"></slot></div></lay-them></div><div class="expanded glass" style="z-index:10000;backdrop-filter:blur(4px);display:${e.showMenu?"block":"none"}"><lay-them in="row" ca="stretch" ma="flex-start"><div style="background-color:#fff;flex:2 1 auto;max-width:250px;box-shadow:${this.theme.scaffold_menu_shadow}"><slot name="menu"></slot></div><div style="flex:1 1 auto" @click="${this.toggleMenuBar}"></div></lay-them></div><div class="snack-bar" style="border-radius:${this.theme.cornerRadius};display:${e.showSnackbar?"block":"none"}"><div style="color:#fff">${e.snackBarMessage}</div></div></lay-them></div>`}}customElements.define("ut-scaffold",oe);customElements.define("ut-scaffold-menu-button",class extends y{constructor(){super("ScaffoldBloc"),this.toggleMenuBar=()=>{setTimeout((()=>{var e;null===(e=this.bloc)||void 0===e||e.toggleMenu(!0)}),300),this.shadowRoot.querySelector("#animateTransform5322").beginElement()}}builder(e){return o`<svg style="fill:${this.theme.scaffold_menu_icon_color}" width="10mm" height="10mm" viewBox="0 0 25 25" version="1.1" id="svg845" preserveAspectRatio="xMidYMid" anigen:version="0.8.1" @click="${this.toggleMenuBar}"><g id="icon" transform="translate(-1.5748032e-7,1.4999999)"><rect style="stroke-width:1.92378;stroke-linejoin:round;stroke-opacity:.658819" id="rect835" width="15" height="2" x="5" y="5"/><rect style="stroke-width:1.92378;stroke-linejoin:round;stroke-opacity:.658819" id="rect837" width="15" height="2" x="5" y="10"/><rect style="stroke-width:1.92378;stroke-linejoin:round;stroke-opacity:.658819" id="rect839" width="15" height="2" x="5" y="15"/><animateTransform attributeName="transform" attributeType="auto" type="rotate" values="0 12.50589307470144 10.997459956419888;180 12.50589307470144 10.997459956419888" calcMode="spline" keyTimes="0;1" keySplines="0 0 1 1" dur="0.3s" begin="indefinite" repeatCount="1" additive="sum" accumulate="none" fill="freeze" id="animateTransform5322"/></g></svg>`}});class re extends t{constructor(e){super(e),this._name="I18NBloc"}changeLanguage(e){this.emit(e)}getText(e){if(e){let t=e.toLowerCase(),i=this.state[t];return i||e}}}class ae extends i{builder(){return o`<div style="width:100%;height:100%"><slot></slot></div>`}constructor(e){super({I18NBloc:new re(e)})}}class ne extends y{constructor(){super("I18NBloc"),this._font_size="1em"}get key(){return this._key}set key(e){this._key=e,this.bloc&&this._build(this.bloc.state)}builder(e){var t;let i=null!==(t=this.key)&&void 0!==t?t:this.textContent;return i?o`<span style="font-size:${this._font_size};color:${this.color};user-select:${this.style.userSelect?this.style.userSelect:"none"}">${ne._getText(i,e)}</span>`:r}get color(){var e;return(null!==(e=this.style.color)&&void 0!==e?e:this.getAttribute("color"))||this.theme.color}set font_size(e){this._font_size=e}static _getText(e,t){if(e){let i=e.toLowerCase();return t[i]?t[i]:e}}}class le extends ne{constructor(){super(),this.font_size=this.theme.P_font_size}}customElements.define("ut-p",le);class ce extends ne{constructor(){super(),this.font_size=this.theme.H1_font_size}}customElements.define("ut-h1",ce);class he extends ne{constructor(){super(),this.font_size=this.theme.H2_font_size}}customElements.define("ut-h2",he);class de extends ne{constructor(){super(),this.font_size=this.theme.H3_font_size}}customElements.define("ut-h3",de);class ue extends ne{constructor(){super(),this.font_size=this.theme.H5_font_size}}customElements.define("ut-h5",ue);class me extends ne{constructor(){super(),this.font_size=this.theme.H6_font_size}}customElements.define("ut-h6",me);class pe extends ne{constructor(){var e,t;super(),this.font_size=null!==(t=null===(e=this.useAttribute)||void 0===e?void 0:e.font_size)&&void 0!==t?t:this.theme.P_font_size}}customElements.define("ut-txt",pe);class ge extends y{constructor(){super("BogusBloc",{blocs_map:{BogusBloc:new f}})}builder(e){return o`<div style="width:100%;height:100%"><slot></slot></div>`}}customElements.define("ut-ex",ge);class ve extends t{constructor(){super({}),this._name="FormMessageBloc"}postMessage(e,t){this.state[e]=t,this.emit({...this.state})}}class _e extends t{constructor(e,t="FormMessageBloc"){super(e),this.formMessageBlocName=t}disableAnInput(e){this.state.areDisabled||(this.state.areDisabled=new Set),this.state.areDisabled.add(e),this.emit({...this.state})}enableAnInput(e){this.state.areDisabled&&this.state.areDisabled.delete(e),this.emit({...this.state})}isDisabled(e){return!!this.state.areDisabled&&this.state.areDisabled.has(e)}_basicOnChange(e){return t=>{if(t)this.state[e]=t,this.emit({...this.state});else{let t={...this.state};delete t[e],this.emit(t)}}}delegateChangeTo(e,t,s){const o=this._basicOnChange(e),r=this.validatorFunctionGiver(e),a=this.postOnChangeFunctionGiver(e);if(o){let n;o(t),r&&(n=r(t),s||(s=i.search(this.formMessageBlocName,this.hostElement)),s.postMessage(e,n)),a&&a(t,n)}}checkAllValidationPassed(){let e=i.search(this.formMessageBlocName,this.hostElement),t=JSON.parse(JSON.stringify(e.state));return!(Object.keys(t).length>0)}}class be extends y{constructor(e){super(e.bloc_name),this.config=e}get disabled(){return!this.bloc||this.bloc.isDisabled(this.config.name)}connectedCallback(){super.connectedCallback(),setTimeout((()=>{this.hasChanged=e=>{var t;null===(t=this.bloc)||void 0===t||t.delegateChangeTo(this.config.name,e)}}))}}class fe extends y{constructor(e="FormMessageBloc"){super(e),this.formMessageBlocName=e}connectedCallback(){super.connectedCallback(),setTimeout((()=>{let e=this.getAttribute("for");if(!e)throw"No for attribute present on a form message";this.name=e}))}builder(e){if(!this.name)return r;let t=e[this.name];return o`<span>${t}</span>`}}customElements.define("form-message",fe);class ye extends i{builder(){return o`<div><slot></slot></div>`}constructor(e){super((()=>{let t=e.name,i={FormMessageBloc:new ve};return i[t]=e,i})())}}class xe extends y{constructor(e,t,i=[20,80]){super(e,t),this.shades=i,this.buttonAction=()=>{navigator.vibrate(v.PRESS_VIB),this.onPress()}}isDisabled(){return!!this.hasAttribute("disabled")}builder(e){return o`
            <style>
                .ripple {
                background-position: center;
                transition: background 0.8s;
                }
                .ripple:hover {
                    background: ${this.onPressButtonColor} radial-gradient(circle, transparent 1%, ${this.onPressButtonColor} 1%) center/15000%;
                }
                .ripple:active {
                    background-color: ${this.light};
                    background-size: 100%;
                    transition: background 0s;
                }
                .button{
                    box-shadow: 1px 1px 3px 0px #0000006e;
                    display: flex;
                    flex-direction: column;
                    flex-wrap: nowrap;
                    justify-content: center;
                    align-items: stretch;
                    user-select: none; 
                    min-height: ${this.theme.button_height};
                    text-align: center; 
                    background-color: ${this.isDisabled()?this.theme.button_disable_color:this.bgColor};
                    border-radius:${this.theme.cornerRadius}
                }
                .button:active{
                    box-shadow: 0px 0px 0px 0px #0000009e
                }
            </style>
            <div class="${(()=>this.isDisabled()?"button":"ripple button")()}" @click=${{handleEvent:e=>{this.isDisabled()||this.buttonAction()},capture:!1}}><slot></slot></div>
        `}connectedCallback(){super.connectedCallback(),setTimeout((()=>{this.bgColor=this.theme.primaryColor,this.onPressButtonColor=p.shadeColor(this.bgColor,this.shades[0]),this.light=p.shadeColor(this.bgColor,this.shades[1]),this._build(this.state)}))}}class we extends x{get icon(){let e=this.getAttribute("icon");if(!e)throw"No icon provided";return e}get label(){return this.getAttribute("label")}builder(e){var t,i;const s=null===(t=this.useAttribute)||void 0===t?void 0:t.color;return o`
        <ink-well>
            <lay-them ca="center" ma="center">
                <ut-icon icon="${this.icon}" use="icon_inactive: ${s}"></ut-icon>
                <ut-h5 use="color: ${s};" .key=${null!==(i=this.label)&&void 0!==i?i:""}></ut-h5>
            </lay-them>
        </ink-well>
        <slot></slot>
        `}}customElements.get("labeled-icon-button")||customElements.define("labeled-icon-button",we);class ke extends x{builder(e){var t,i,s;const r=null!==(i=null===(t=this.useAttribute)||void 0===t?void 0:t.radius)&&void 0!==i?i:"50px",a=null===(s=this.useAttribute)||void 0===s?void 0:s.icon;if(!a)throw"No icon provided in use attribute for circular-icon-button";return o`
        <div style="overflow: hidden;height: ${r};width: ${r};background-color: var(--bg-color,#7b7b7b12);border-radius: 50%;">
            <ink-well><lay-them ma="center" ca="center"><ut-icon icon="${a}" use="icon_inactive: ${this.theme.primaryColor}"></ut-icon></lay-them></ink-well>
        </div>`}}customElements.get("circular-icon-button")||customElements.define("circular-icon-button",ke);class Be extends xe{constructor(){super("BogusBloc",{blocs_map:{BogusBloc:new f}})}}class Te extends y{constructor(){if(super("BogusBloc",{blocs_map:{BogusBloc:new f}}),this.gradient_colors=`#${this.theme.primaryColor},#${this.theme.secondaryColor}`,this.useAttribute){let e=this.useAttribute.gradients;e&&(this.gradient_colors=e)}}builder(e){return o`<style>.animated-gradient{background:linear-gradient(-45deg,${this.gradient_colors});background-size:400% 400%;animation:gradient 15s ease infinite}@keyframes gradient{0%{background-position:0 50%}50%{background-position:100% 50%}100%{background-position:0 50%}}.expanded{width:100%;height:100%}</style><div class="animated-gradient expanded"></div>`}}customElements.define("animated-grad-bg",Te);class Ee extends y{builder(e){throw new Error("Method not implemented.")}constructor(){super("BogusBloc",{blocs_map:{BogusBloc:new f}})}}!function(e){e[e.NO_ACTION=0]="NO_ACTION",e[e.TAP=1]="TAP",e[e.SWIPE_LEFT=2]="SWIPE_LEFT",e[e.SWIPE_RIGHT=3]="SWIPE_RIGHT",e[e.SWIPE_UP=4]="SWIPE_UP",e[e.SWIPE_DOWN=5]="SWIPE_DOWN",e[e.DOUBLE_TAP=6]="DOUBLE_TAP"}(S||(S={}));class Ie extends t{constructor(e,t,i){super(S.NO_ACTION),this.drag_sensitivity=e,this.minDistanceInPx=t,this.doubleTapTimer=i,this._name="GestureDetectorBloc",this.isDragging=!1,this._posStartX=-1,this._posStartY=-1,this._posEndX=-1,this._posEndY=-1,this._posCurrX=-1,this._posCurrY=-1,e>1?e=1:e<0&&(e=0),t<0&&(this.minDistanceInPx=Math.abs(t))}onStart(e,t){this._posStartX=e,this._posStartY=t}onMove(e,t){this.isDragging=!0,this._posCurrX=e,this._posCurrY=t}onEnd(e,t){if(this._posEndX=e,this._posEndY=t,this.isDragging){this.isDragging=!1;let e=(this._posEndX-this._posStartX)*this.drag_sensitivity,t=(this._posEndY-this._posStartY)*this.drag_sensitivity;Math.abs(e)>=Math.abs(t)?e>0?Math.abs(e)>this.minDistanceInPx?this.emit(S.SWIPE_RIGHT):this.emit(S.NO_ACTION):Math.abs(e)>this.minDistanceInPx?this.emit(S.SWIPE_LEFT):this.emit(S.NO_ACTION):t>0?Math.abs(t)>this.minDistanceInPx?this.emit(S.SWIPE_DOWN):this.emit(S.NO_ACTION):Math.abs(t)>this.minDistanceInPx?this.emit(S.SWIPE_UP):this.emit(S.NO_ACTION)}else this._clickTimer?(clearTimeout(this._clickTimer),this._clickTimer=void 0,this.emit(S.DOUBLE_TAP)):this._clickTimer=setTimeout((()=>{this._clickTimer=void 0,this.emit(S.TAP)}),this.doubleTapTimer)}}class $e extends y{constructor(e=1,t=100,i=300){super("GestureDetectorBloc",{blocs_map:{GestureDetectorBloc:new Ie(e,t,i)},buildWhen:(e,t)=>t!==S.NO_ACTION}),this.drag_sensitivity=e,this.minDistanceInPx=t,this.doubleTapTimer=i,this.handle_touch_start=e=>{var t;e.stopPropagation(),null===(t=this.bloc)||void 0===t||t.onStart(e.changedTouches[0].clientX,e.changedTouches[0].clientY)},this.handle_touch_end=e=>{var t;e.stopPropagation(),null===(t=this.bloc)||void 0===t||t.onEnd(e.changedTouches[0].clientX,e.changedTouches[0].clientY)},this.handle_touch_move=e=>{var t;e.stopPropagation(),null===(t=this.bloc)||void 0===t||t.onMove(e.changedTouches[0].clientX,e.changedTouches[0].clientY)}}connectedCallback(){super.connectedCallback(),this.addEventListener("touchstart",this.handle_touch_start,!1),this.addEventListener("touchend",this.handle_touch_end,!1),this.addEventListener("touchmove",this.handle_touch_move,!1)}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("touchstart",this.handle_touch_start,!1),this.removeEventListener("touchend",this.handle_touch_end,!1),this.removeEventListener("touchmove",this.handle_touch_move,!1)}}class Pe extends y{constructor(e=1,t=100,i=300,s=!1){super("GestureDetectorBloc",{blocs_map:{GestureDetectorBloc:new Ie(e,t,i)},buildWhen:(e,t)=>t!==S.NO_ACTION}),this.drag_sensitivity=e,this.minDistanceInPx=t,this.doubleTapTimer=i,this.capture=s,this._onTouchStart={handleEvent:e=>{var t;null===(t=this.bloc)||void 0===t||t.onStart(e.changedTouches[0].clientX,e.changedTouches[0].clientY),e.stopPropagation()},capture:this.capture},this._onTouchEnd={handleEvent:e=>{var t;null===(t=this.bloc)||void 0===t||t.onEnd(e.changedTouches[0].clientX,e.changedTouches[0].clientY),e.stopPropagation()},capture:this.capture},this._onTouchMove={handleEvent:e=>{var t;null===(t=this.bloc)||void 0===t||t.onMove(e.changedTouches[0].clientX,e.changedTouches[0].clientY),e.stopPropagation()},capture:this.capture},this.onSwipeUp=()=>{},this.onSwipeDown=()=>{},this.onSwipeLeft=()=>{},this.onSwipeRight=()=>{},this.onTap=()=>{},this.onDoubleTap=()=>{}}builder(e){switch(e){case S.NO_ACTION:break;case S.TAP:this.onTap();break;case S.SWIPE_LEFT:this.onSwipeLeft();break;case S.SWIPE_RIGHT:this.onSwipeRight();break;case S.SWIPE_UP:this.onSwipeUp();break;case S.SWIPE_DOWN:this.onSwipeDown();break;case S.DOUBLE_TAP:this.onDoubleTap()}return o`<div style="width:100%;height:100%" @touchstart="${this._onTouchStart}" @touchend="${this._onTouchEnd}" @touchmove="${this._onTouchMove}"><slot></slot></div>`}}class Ce extends t{constructor(e=0){super(e),this._name="CircularCounterBloc",this._current_index=0,this._max_count=0}setMaxCount(e){this._max_count=e}get current_index(){if(0===this._max_count)throw"setMaxCount has not been called on : CircularCounterBloc";return this._current_index}set current_index(e){this._current_index=e,this.emit(this._current_index)}increment(){this.current_index>=this._max_count-1?this.current_index=0:this.current_index++}decrement(){this.current_index<=0?this.current_index=this._max_count-1:this.current_index--}}class Se extends Pe{constructor(){super(1,100),this.onSwipeLeft=()=>{navigator.vibrate(v.PRESS_VIB),this.circularCounterBloc.increment()},this.onSwipeRight=()=>{navigator.vibrate(v.PRESS_VIB),this.circularCounterBloc.decrement()}}get circularCounterBloc(){return this._circularCounterBloc||(this._circularCounterBloc=Ce.search("CircularCounterBloc",this)),this._circularCounterBloc}}customElements.get("ut-horizontal-circular-slider-gesture-detector")||customElements.define("ut-horizontal-circular-slider-gesture-detector",Se);class Ae extends i{constructor(e=0){super({CircularCounterBloc:new Ce(e)})}builder(){return o`<ut-horizontal-circular-slider-gesture-detector><slot></slot></ut-horizontal-circular-slider-gesture-detector>`}}customElements.get("ut-horizontal-circular-slider")||customElements.define("ut-horizontal-circular-slider",Ae);class Oe extends i{constructor(){super(...arguments),this._doListenScroll={handleEvent:e=>{let t=e.target;t.offsetHeight+t.scrollTop>=t.scrollHeight?(navigator.vibrate(v.PRESS_VIB),this.bottomLimitReached()):0===t.scrollTop&&(navigator.vibrate(v.PRESS_VIB),this.topLimitReached()),e.stopPropagation()},capture:!1},this._discardTouch={handleEvent:e=>{e.stopPropagation()},capture:!1}}disconnectedCallback(){var e;null===(e=this._scroller)||void 0===e||e.removeEventListener("scroll",this._doListenScroll)}connectedCallback(){super.connectedCallback()}builder(){let e=this.getAttribute("snap");return o`<style>.con{overflow-y:scroll;height:100%;width:100%;scroll-behavior:smooth;scroll-snap-type:${e||"none"}}.con::-webkit-scrollbar{display:none}</style><div class="con" @scroll="${this._doListenScroll}" @touchstart="${this._discardTouch}" @touchend="${this._discardTouch}" @touchmove="${this._discardTouch}"><slot></slot></div>`}}class Re extends i{constructor(){super(...arguments),this._doListenScroll={handleEvent:e=>{let t=e.target;t.offsetWidth+t.scrollLeft===t.scrollWidth?(navigator.vibrate(v.PRESS_VIB),this.rightLimitReached()):0===t.scrollLeft&&(navigator.vibrate(v.PRESS_VIB),this.leftLimitReached()),e.stopPropagation()},capture:!1},this._discardTouch={handleEvent:e=>{e.stopPropagation()},capture:!1}}disconnectedCallback(){var e;null===(e=this._scroller)||void 0===e||e.removeEventListener("scroll",this._doListenScroll)}connectedCallback(){super.connectedCallback()}builder(){let e=this.getAttribute("snap");return o`<style>.con{overflow-x:scroll;height:100%;width:100%;display:flex;scroll-behavior:smooth;scroll-snap-type:${e||"none"}}.con::-webkit-scrollbar{display:none}</style><div class="con" @scroll="${this._doListenScroll}" @touchstart="${this._discardTouch}" @touchend="${this._discardTouch}" @touchmove="${this._discardTouch}"><slot></slot></div>`}}class De extends t{}customElements.define("ut-pan-zoom-detector",class extends y{constructor(){super(...arguments),this.initDistance=0,this.axis={x:0,y:0},this.handleStart={handleEvent:e=>{var t;e.stopPropagation();const i=e.touches[0],s=e.touches[1];if(s){let e=Math.min(i.screenX,s.screenX),t=Math.min(i.screenY,s.screenY);this.axis={x:e+Math.abs(i.screenX-s.screenX),y:t+Math.abs(i.screenY-s.screenY)},this.touch2PointerID=s.identifier,this.initDistance=Math.abs(i.screenY-s.screenY)}else this.tapedOnceTimer?(clearTimeout(this.tapedOnceTimer),this.tapedOnceTimer=void 0,null===(t=this.bloc)||void 0===t||t.onDoublePointTouch({x:i.screenX,y:i.screenY})):this.tapedOnceTimer=setTimeout((()=>{var e;this.tapedOnceTimer=void 0,null===(e=this.bloc)||void 0===e||e.onPointTouch({x:i.screenX,y:i.screenY})}),v.PinchZoomBlocDoubleTapTime),this.axis.x=i.screenX,this.axis.y=i.screenY,this.touch2PointerID=void 0;return!1},capture:!0},this.handleEnd={handleEvent:e=>{var t;if(this.init(),1===e.changedTouches.length){let i=e.changedTouches[0];null===(t=this.bloc)||void 0===t||t.onPointRelease({x:i.screenX,y:i.screenY})}},capture:!0},this.prevZoom=1,this.handleMove={handleEvent:e=>{var t,i;e.stopPropagation();const s=e.touches[0];let o;if(this.touch2PointerID&&2==e.touches.length)for(let t=0;t<e.touches.length;t++)if(e.touches[t].identifier===this.touch2PointerID){o=e.touches[t];break}if(o){const e=Math.abs(s.screenY-o.screenY)/this.initDistance;this.prevZoom!==e&&(null===(i=this.bloc)||void 0===i||i.onZoom(e,this.axis),this.prevZoom=e)}else{const e={x:s.screenX,y:s.screenY};this.prevPan||(this.prevPan=e),this.isNotEqual(this.prevPan,e)&&(null===(t=this.bloc)||void 0===t||t.onPan({x:e.x-this.prevPan.x,y:e.y-this.prevPan.y},this.axis),this.prevPan=e)}return!1},capture:!0}}calculateDistance1(e,t){return Math.sqrt((e.x-t.x)**2+(e.y-t.y))}init(){this.initDistance=0,this.prevPan=void 0,this.touch2PointerID=void 0,this.axis={x:0,y:0},this.prevZoom=1}isNotEqual(e,t){return e.x!==t.x||e.y!==t.y}builder(e){return o`<div id="target" style="width:100%;height:100%" @touchstart="${this.handleStart}" @touchmove="${this.handleMove}" @touchend="${this.handleEnd}"><slot></slot></div>`}});class Me extends F{constructor(){super(),this._name="TabRouterBloc",this._number_of_routes=0}define(e){super.define(e),this._number_of_routes++}get number_of_routes(){return this._number_of_routes}get current_index(){let e=this.state.url_path;return"/"===e?0:parseInt(e.substring(1))}}class Ne extends y{constructor(){super("TabRouterBloc")}get icon(){if(!this._icon){let e=this.getAttribute("icon");if(!e)throw"No icon attribute provided for tab header";this._icon=e}return this._icon}get indexpath(){if(!this._indexpath){let e=this.getAttribute("indexpath");if(!e)throw"no indexpath attribute provided";this._indexpath=e}return this._indexpath}connectedCallback(){var e;super.connectedCallback(),this.icon,this.indexpath,a(this.builder(null===(e=this.bloc)||void 0===e?void 0:e.state),this.shadowRoot)}builder(e){return o`<style>.icon{background-color:${e.url_path===this.indexpath?"#fafafa":this.theme.tab_inactive_color};width:100%;height:100%;flex:1;min-width:50px;display:flex;flex-direction:column;justify-content:center;align-items:center}.symbol{color:${e.url_path===this.indexpath?this.theme.tab_active_icon_color:this.theme.tab_inactive_icon_color};font-size:25px}</style><ink-well><div class="icon" @click="${()=>{var e;null===(e=this.bloc)||void 0===e||e.goToPage(this._indexpath,{saveToBrowserHistory:!1,title:""})}}"><lay-them ca="center" ma="center">${this.icon.startsWith("emoji:")?o`<div class="symbol">${this._icon.split(":")[1]}</div>`:o`<ut-icon icon="${this._icon}" use="icon_inactive: ${e.url_path===this.indexpath?this.theme.tab_active_icon_color:this.theme.tab_inactive_icon_color}"></ut-icon>`} ${this.label?o`<ut-h5>${this.label}</ut-h5>`:""}</lay-them></div></ink-well>`}}customElements.define("ut-tab-header",Ne);customElements.define("tabs-gesture-detector",class extends Pe{constructor(){super(1,100,300,!0),this.onSwipeLeft=()=>{if(this._routeBloc){let e;e=this._routeBloc.current_index>=this._routeBloc.number_of_routes-1?0:this._routeBloc.current_index+1,this._routeBloc.goToPage(`/${0===e?"":e}`,{saveToBrowserHistory:!1,title:""})}},this.onSwipeRight=()=>{if(this._routeBloc){let e;e=this._routeBloc.current_index<=0?this._routeBloc.number_of_routes-1:this._routeBloc.current_index-1,this._routeBloc.goToPage(`/${0===e?"":e}`,{saveToBrowserHistory:!1,title:""})}}}connectedCallback(){super.connectedCallback();let e=i.search("TabRouterBloc",this);if(!e)throw"No TabRouterBloc found for gesture detector for tabs";this._routeBloc=e}});class ze extends y{constructor(){super("BogusBloc",{blocs_map:{BogusBloc:new f,TabRouterBloc:new Me}})}getHeaders(){if(this._headers)return this._headers;{let e=this.querySelectorAll("ut-tabs > ut-tab");if(e.length>0){let t={};for(let i=0;i<e.length;i++){let s=e[i],o=s.getAttribute("icon"),r=s.getAttribute("label");if(!o)throw"No icon defined for tab index: ${i}";if(!s.getAttribute("route"))throw"No route attribute present";t[o]={path:0===i?"/":`/${i}`,label:r}}return o`<lay-them in="row" ma="start" ca="stretch">${Object.keys(t).map((e=>o`<div class="icon"><ut-tab-header icon="${e}" indexpath="${t[e].path}" .label="${t[e].label}"></ut-tab-header></div>`))}</lay-them>`}throw"No Tabs defined for tabs controller"}}getBody(){return this.hasAttribute("disableswipe")?o`<slot></slot>`:o`<tabs-gesture-detector><slot></slot></tabs-gesture-detector>`}builder(e){return o`<style>.headers{height:${this.theme.tab_header_height};width:auto;margin:${this.theme.tab_header_margin};border-radius:${this.theme.tab_header_border_radius};overflow:${this.theme.tab_header_overflow};box-shadow:${this.theme.tab_header_bar_shadow};z-index:${this.theme.tab_header_zIndex};box-sizing:border-box;padding:${this.theme.tab_header_padding}}.icon{flex:1}.body{flex:1;height:100%;overflow-y:scroll}.body::-webkit-scrollbar{display:none}</style><lay-them ma="start"><div class="headers">${this.getHeaders()}</div><div class="body">${this.getBody()}</div></lay-them>`}}customElements.define("ut-tab-controller",ze);class Le extends H{constructor(){super("ut-tab","TabRouterBloc")}builder(e){return o`<div style="width:100%;height:100%"><slot></slot></div>`}}customElements.define("ut-tabs",Le);class Fe extends G{constructor(){super("TabRouterBloc"),this.index=-1;let e=this.getAttribute("index");if(!e)throw"No attribute index attribute given on the tab";{this.index=parseInt(e);let t="0"===e?"/":`/${e}`;this.setAttribute("route",t)}}_getBaseTemplate(e){return o`<style>.hide{display:none}.show{display:block}.expanded{width:100%;height:100%}</style><div class="expanded ${e?"hide":"show"}"><slot></slot></div>`}}customElements.define("ut-tab",Fe);class Ve extends y{constructor(){super("BogusBloc",{blocs_map:{BogusBloc:new f}}),this._actionOnPress=e=>{navigator.vibrate(v.PRESS_VIB),this.onpressaction(e)};let e="#000";if(this.useAttribute){let t=this.useAttribute.ripple_color;t&&(e=t)}this.ripple_color=e}onpressaction(e){}builder(e){return o`<style>.ripple{position:relative;overflow:hidden;transform:translate3d(0,0,0);width:100%;height:100%}.ripple:after{content:"";display:block;position:absolute;width:100%;height:100%;top:0;left:0;pointer-events:none;background-image:radial-gradient(circle,${this.ripple_color} 10%,transparent 10.01%);background-repeat:no-repeat;background-position:50%;transform:scale(10,10);opacity:0;transition:transform .5s,opacity 1s}.ripple:active:after{transform:scale(0,0);opacity:.2;transition:0s}</style><div class="ripple" @click="${{handleEvent:e=>{this._actionOnPress(e)},capture:!1}}"><slot></slot></div>`}}customElements.define("ink-well",Ve);class He extends be{constructor(e,t){super(e),this.valueList=t,this.haveChanged=e=>{this.hasChanged(e.target.value)},this.getDataList=()=>{if(this.valueList)return o`<datalist id="dataList">${this.valueList.map((e=>o`<option value="${e}"></option>`))}</datalist>`},this.getClearButton=()=>{if(this.config.clearable||this.valueList)return o`<div style="padding:5px" @click="${this.clearText}"><ut-icon icon="clear" use="icon_inactive: ${this.theme.input_icon_color};"></ut-icon></div>`},this.getIcon=()=>{if(this.config.icon)return o`<div class="iconCtrl"><ut-icon icon="${this.config.icon}" use="icon_inactive: ${this.theme.input_icon_color};"></ut-icon></div>`},this.clearText=()=>{var e;(null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector("#sli")).value="",this.hasChanged()}}builder(e){var t;return o`<style>.glass{background-color:${this.theme.input_bg_color}}.sli-bg{width:100%;min-height:${this.theme.input_height};border-radius:${this.theme.cornerRadius}}input{background:0 0;border:none;font-size:1em;caret-color:${this.theme.input_cursor_color};color:${this.theme.input_text_color};padding:${this.theme.input_padding};-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;font-weight:${this.theme.input_font_weight}}input:focus{outline-width:0}input::placeholder{color:${this.theme.input_place_holder_color}}.iconCtrl{display:flex;flex-direction:row;justify-content:center;align-items:center;padding-left:5px}</style>${this.getDataList()}<div class="sli-bg glass"><lay-them in="row">${this.getIcon()}<div style="flex:1"><lay-them in="row" ca="center"><input id="sli" @focus="${()=>{navigator.vibrate(v.PRESS_VIB)}}" ?disabled="${this.disabled}" @input="${this.haveChanged}" list="${l(this.dataList)}" inputmode="${l(this.config.inputmode)}" .value="${null!==(t=e[this.config.name])&&void 0!==t?t:""}" class="sli-bg" placeholder="${l(this.config.placeholder)}" type="${l(this.config.type)}"> ${this.getClearButton()}</lay-them></div></lay-them></div>`}get dataList(){if(this.valueList)return"dataList"}}class Ge extends be{constructor(e){super(e),this.haveChanged=e=>{let t=e.currentTarget;this.hasChanged(t.value)}}builder(e){return o`<textarea placeholder="${l(this.config.placeholder)}" @focus="${()=>{navigator.vibrate(v.PRESS_VIB)}}" @keyup="${this.haveChanged}" style="padding:10px;outline:0;resize:none;width:100%;height:100%;box-sizing:border-box;min-height:100px;background-color:${this.theme.input_bg_color};border-radius:${this.theme.cornerRadius};border:none" type="text">${e[this.config.name]}</textarea>`}}!function(e){e[e.LOADING=0]="LOADING",e[e.LOADED=1]="LOADED"}(A||(A={}));class Ue extends t{constructor(e=!0,t=Ue.SearchItemByStringMatch){super({listOfItems:[],status:A.LOADING}),this.call_onchange_on_selection=e,this.filterFunctionForSearchSelector=t,this._selectedItems=new Set,setTimeout((()=>{this.loadItems().then((e=>{this.initialize(e)}))}))}get selectedItems(){return this._selectedItems}initialize(e){try{return this.fullListOfItemLoadedInitially=e,this.currentListOfItems=this.fullListOfItemLoadedInitially,this.emit({listOfItems:this.currentListOfItems,status:A.LOADED}),!0}catch(e){return console.error(e),!1}}_toggleItemSelection(e,t,i=!1){navigator.vibrate(v.PRESS_VIB),this._isItemSelected(e)?this._selectedItems.delete(e):this._selectedItems.add(e),this.emit({...this.state,last_item_interactedWith:e}),!i&&this.call_onchange_on_selection&&this.onchange(this._selectedItems,t)}_isItemSelected(e){return this._selectedItems.has(e)}get _isMaxItemSelected(){return!(this.maxNumberOfSelect<=0)&&!(this._selectedItems.size<this.maxNumberOfSelect)}_removeFirst(e){let t=0;for(let i of this._selectedItems){if(!(t<1))break;this._toggleItemSelection(i,e,!0),t++}}unselectAll(){this._selectedItems.clear(),this.emit({...this.state,last_item_interactedWith:void 0})}post_change(){this.onchange(this._selectedItems,this.hostElement),this.state.listOfItems=this.fullListOfItemLoadedInitially,this.unselectAll()}cancel(){this.onchange(new Set,this.hostElement),this.state.listOfItems=this.fullListOfItemLoadedInitially,this.unselectAll()}find(e,t){var i;if(e&&0!==e.trim().length){let s=this.filterFunctionForSearchSelector(null!==(i=this.fullListOfItemLoadedInitially)&&void 0!==i?i:[],e,t);this.emit({...this.state,listOfItems:s})}else this.emit({...this.state,listOfItems:this.fullListOfItemLoadedInitially})}static SearchItemByStringMatch(e,t,i){var s;let o=new RegExp(t,"i");return null!==(s=null==e?void 0:e.filter((e=>o.test(e[i]))))&&void 0!==s?s:[]}}class We extends y{constructor(e){super(e)}_itemBuilder(e,t,i){const s=this.bloc._isMaxItemSelected;return o`<div @click="${t=>{var i,o;s&&(null===(i=this.bloc)||void 0===i||i._removeFirst(this)),null===(o=this.bloc)||void 0===o||o._toggleItemSelection(e,this)}}" class="${i?"item selected":"item"}">${this.itemBuilder(e,t,this.bloc._isItemSelected(e))}</div>`}selectedColor(){var e;return(null===(e=this.useAttribute)||void 0===e?void 0:e["selection-color"])||this.theme.selector_item_selection_color}builder(e){switch(e.status){case A.LOADING:return o`<lay-them ma="center" ca="center"><div><circular-progress-indicator></circular-progress-indicator></div></lay-them>`;case A.LOADED:return o`<style>.selected{background-color:${this.selectedColor()};color:#fff}</style><lay-them in="column" ma="flex-start" ca="stretch">${c(e.listOfItems,(e=>{var t;return`${null===(t=this.bloc)||void 0===t?void 0:t._isItemSelected(e)}_${this.itemToKey(e)}`}),((e,t)=>this._itemBuilder(e,t,this.bloc._isItemSelected(e))))}</lay-them>`}}}class je extends y{constructor(e){super(e)}_itemBuilder(e,t,i){const s=this.bloc._isMaxItemSelected;return o`<div @click="${t=>{var i,o;s&&(null===(i=this.bloc)||void 0===i||i._removeFirst(this)),null===(o=this.bloc)||void 0===o||o._toggleItemSelection(e,this)}}" class="${i?"selected":""}">${this.itemBuilder(e,t,this.bloc._isItemSelected(e))}</div>`}selectedColor(){var e;return(null===(e=this.useAttribute)||void 0===e?void 0:e["selection-color"])||this.theme.selector_item_selection_color}builder(e){switch(e.status){case A.LOADING:return o`<lay-them ma="center" ca="center"><div><circular-progress-indicator></circular-progress-indicator></div></lay-them>`;case A.LOADED:return o`<style>.selected{background-color:${this.selectedColor()}}</style><lay-them in="row" ma="flex-start" wrap="wrap">${c(e.listOfItems,(e=>{var t;return`${null===(t=this.bloc)||void 0===t?void 0:t._isItemSelected(e)}_${this.itemToKey(e)}`}),((e,t)=>this._itemBuilder(e,t,this.bloc._isItemSelected(e))))}</lay-them>`}}}class Ye{static create(e,t){class s extends Ue{constructor(){super(!1,e.filterFunctionForSearchSelector),this.maxNumberOfSelect=e.maxNumberOfSelect,this.loadItems=e.loadItemsFunction,this.onchange=e.onChangeFunction,this._name="ISelectorBloc"}}let a;a="list"===e.selector_type?class extends We{constructor(){super("ISelectorBloc"),this.itemBuilder=e.itemBuilderFunction}itemToKey(t){return t[e.id_key_name]}}:class extends je{constructor(){super("ISelectorBloc"),this.itemBuilder=e.itemBuilderFunction}itemToKey(t){return t[e.id_key_name]}};let l=e.tag_name+"-selector-widget";customElements.get(l)||customElements.define(l,a);class c extends _e{constructor(){super({}),this._name="SearchFormBloc"}validatorFunctionGiver(e){if("search_string"===e)return e=>{if(e&&e.length>100)return"only_100_char"}}postOnChangeFunctionGiver(t){if(this.selectorBloc||(this.selectorBloc=i.search("ISelectorBloc",this.hostElement)),"search_string"===t)return(t,i)=>{var s;null===(s=this.selectorBloc)||void 0===s||s.find(t,e.search_key_name)}}}class h extends He{constructor(){super({bloc_name:"SearchFormBloc",name:"search_string",clearable:!0,icon:"search",placeholder:e.search_placeholder,inputmode:e.inputmode})}}const d=e.tag_name+"-search-input";customElements.get(d)||customElements.define(d,h);class u extends y{constructor(){super(e.selector_hide_bloc_name,{blocs_map:{ISelectorBloc:new s,SearchFormBloc:new c,FormMessageBloc:new ve}}),this.acceptSelection=s=>{var o,r;let a=i.search("ISelectorBloc",this);t?t.onAccept(null==a?void 0:a.selectedItems,this):(null===(o=e.onAccept)||void 0===o||o.call(e,null==a?void 0:a.selectedItems,this),null===(r=this.bloc)||void 0===r||r.toggle()),null==a||a.post_change()},this.cancelSelection=e=>{var s;let o=i.search("ISelectorBloc",this);null==o||o.cancel(),t?t.onCancel(this):null===(s=this.bloc)||void 0===s||s.toggle()}}get items(){return this._items}set items(e){var t;this._items=e,e&&(null===(t=this.blocBuilderConfig.blocs_map)||void 0===t?void 0:t.ISelectorBloc).initialize(e)}mainSearchableTemplate(){return o`<style>.title_bar{padding:10px;color:#fff;font-size:${this.theme.H2_font_size};background-color:${this.theme.primaryColor};box-shadow:0 2px 3px #00000040;z-index:2}.button{height:40px}.items{flex-grow:1;overflow-y:auto;height:0}.buttons_area{box-shadow:0 -1px 3px #00000040}.search_input{box-shadow:0 2px 3px #00000040;z-index:1}</style><lay-them in="column" ma="flex-start" ca="stretch">${t?r:o`<div class="title_bar"><ut-p use="color:white;">${e.title}</ut-p></div>`}<div class="search_input">${n(`<${d}></${d}`)}</div><div class="items">${n(`<${l}></${l}>`)}</div><div class="buttons_area"><lay-them in="row" ma="flex-start" ca="stretch" overflow="hidden"><div style="flex:1" class="button" @click="${this.acceptSelection}"><ink-well><lay-them ma="center" ca="center"><ut-icon icon="done"></ut-icon></lay-them></ink-well></div><div style="flex:1" class="button" @click="${this.cancelSelection}"><ink-well><lay-them ma="center" ca="center"><ut-icon icon="clear"></ut-icon></lay-them></ink-well></div></lay-them></div></lay-them>`}builder(e){return e?o``:t?o`<backable-screen title="${t.title}">${this.mainSearchableTemplate()}</backable-screen>`:o`<style>.fullscreenGlass{position:fixed;width:100%;height:100%;background-color:${this.theme.dialogue_bg};z-index:10;top:0;left:0}.cont{max-width:95vw;max-height:95vh;min-height:300px;min-width:300px;background-color:#fff;border-radius:${this.theme.cornerRadius};overflow:hidden}</style><div class="fullscreenGlass"><lay-them ma="center" ca="center"><div class="cont">${this.mainSearchableTemplate()}</div></lay-them></div>`}}customElements.get(e.tag_name)||customElements.define(e.tag_name,u)}}class qe extends y{get icon(){let e=this.getAttribute("icon");if(e)return e;throw"use attribute icon must be supplied"}constructor(){super("BogusBloc",{blocs_map:{BogusBloc:new f}})}builder(e){var t,i,s,r,a,n;return o`<style>.icon{display:inline-block;width:${null!==(t=this.theme.icon_size)&&void 0!==t?t:"25px"};height:${null!==(i=this.theme.icon_size)&&void 0!==i?i:"25px"};fill:${null!==(s=this.theme.icon_inactive)&&void 0!==s?s:"#000"}}.icon:active{fill:${null!==(r=this.theme.icon_active)&&void 0!==r?r:"#000"}}.cont1{display:inline-block;width:100%;height:100%}.cont2{width:100%;height:100%;display:flex;justify-content:center;align-items:center}</style><div class="cont1"><div class="cont2"><svg viewBox="0 0 24 24" class="icon">${h(null!==(n=null===(a=document.querySelector("#"+this.icon))||void 0===a?void 0:a.innerHTML)&&void 0!==n?n:'<g id="warning"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"></path></g>')}</svg></div></div>`}}customElements.get("ut-icon")||customElements.define("ut-icon",qe);customElements.define("ut-confirmation-dialogue-progress-indicator",class extends y{constructor(){super("ProgressBloc")}builder(e){return e?o`<div><slot></slot></div>`:o`<lay-them ma="center" ca="center" overflow="hidden"><circular-progress-indicator></circular-progress-indicator></lay-them>`}});class Ze extends y{constructor(e,t){super(e,{blocs_map:{...t.blocs_map,ProgressBloc:new B}}),this._confirmationInfo=t,this.show_in_progress=()=>{var e;null===(e=i.search("ProgressBloc",this))||void 0===e||e.emit(!1)},this.show_buttons=()=>{var e;null===(e=i.search("ProgressBloc",this))||void 0===e||e.emit(!0)},this.user_msg_changed=e=>{const t=e.target;this.user_msg=t.value}}get confirmationInfo(){return this._confirmationInfo}set confirmationInfo(e){var t;e&&(this._confirmationInfo=e,null===(t=this.bloc)||void 0===t||t.emit(this.bloc.state))}builder(e){var t,i,s;return e?r:o`<style>.cont{background-color:#fff;max-width:300px;border-radius:${this.theme.confirmation_dialogue_border_radius};overflow:hidden;box-shadow:0 0 4px}.button{height:40px}.textAreaBG{background-color:${this.theme.input_bg_color};border-radius:${this.theme.cornerRadius};resize:none;width:100%;height:100%;box-sizing:border-box;min-height:100px;border:none;outline:0}.fullscreenGlass{position:fixed;width:100%;height:100%;background-color:${this.theme.dialogue_bg};z-index:10;top:0;left:0;backdrop-filter:blur(3px)}input{width:100%;min-height:40px;border-radius:4px;background:0 0;border:none;font-size:1em;caret-color:#000;color:#000;padding:5px 10px;box-sizing:border-box;font-weight:400;background-color:${this.theme.input_bg_color}}input:focus{outline-width:0}input::placeholder{color:${this.theme.input_place_holder_color}}</style><div class="fullscreenGlass"><div style="width:100%;height:100%"><lay-them ma="center" ca="center"><div class="cont"><lay-them in="column" ma="flex-start" ca="stretch"><div style="padding:10px;color:#fff;font-size:${this.theme.H2_font_size};background-color:${this.theme.primaryColor};background-image:${this.theme.confirmation_dialogue_title_bar_image}">${null===(t=this.confirmationInfo)||void 0===t?void 0:t.title}</div><div style="padding:10px">${n(null===(i=this.confirmationInfo)||void 0===i?void 0:i.msg)}</div><slot></slot>${this.confirmationInfo.user_comments_msg?this.hasAttribute("type")?o`<div style="padding:10px"><input class="sli-bg" type="${null!==(s=this.getAttribute("type"))&&void 0!==s?s:"text"}" placeholder="${this.confirmationInfo.user_comments_msg}" @focus="${()=>{navigator.vibrate(v.PRESS_VIB)}}" @change="${this.user_msg_changed}"></div>`:o`<div style="padding:10px"><textarea class="textAreaBG" @focus="${()=>{navigator.vibrate(v.PRESS_VIB)}}" placeholder="${this.confirmationInfo.user_comments_msg}" @keyup="${this.user_msg_changed}" type="text"></textarea></div>`:o``}<ut-confirmation-dialogue-progress-indicator><lay-them in="row" ma="flex-start" ca="stretch" overflow="hidden"><div style="flex:1" class="button" @click="${this.yesAction}"><ink-well><lay-them ma="center" ca="center"><ut-icon icon="done"></ut-icon></lay-them></ink-well></div><div style="flex:1" class="button" @click="${this.noAction}"><ink-well><lay-them ma="center" ca="center"><ut-icon icon="clear"></ut-icon></lay-them></ink-well></div></lay-them></ut-confirmation-dialogue-progress-indicator></lay-them></div></lay-them></div></div>`}}class Xe extends be{constructor(e,t){super(e),this.valueLabelMap=t,this.onChange=e=>{var t;navigator.vibrate(v.PRESS_VIB);const i=e.target,s=i.getAttribute("value");null===(t=this.bloc)||void 0===t||t.delegateChangeTo(this.config.name,s,ve.search("FormMessageBloc",i))}}get color(){var e;return(null===(e=this.useAttribute)||void 0===e?void 0:e.color)||this.theme.input_radio_button_active_color}builder(e){return o`<style>.active{background-color:${this.color}}.inactive{background-color:${this.theme.input_bg_color}}.radio{width:25px;height:25px;margin-right:5px}</style><lay-them ma="flex-start" ca="stretch">${Object.keys(this.valueLabelMap).map((t=>o`<div style="padding:5px" @click="${this.onChange}" value="${t}"><lay-them in="row" ma="flex-start" ca="center"><div class="radio ${e[this.config.name]===t?"active":"inactive"}" @click="${this.onChange}" value="${t}"></div><ut-p>${this.valueLabelMap[t]}</ut-p></lay-them></div>`))}</lay-them>`}}class Qe extends be{constructor(e,t){super(e),this.checkValue=t,this.haveChanged=e=>{navigator.vibrate(v.PRESS_VIB);let t=e.target.checked?this.checkValue:void 0;this.hasChanged(t)}}connectedCallback(){super.connectedCallback()}builder(e){return o`<style>.container{display:block;position:relative;padding-left:35px;margin-bottom:12px;cursor:pointer;font-size:22px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.container input{position:absolute;opacity:0;cursor:pointer;height:0;width:0}.checkmark{position:absolute;top:0;left:0;height:25px;width:25px;background-color:${this.theme.input_check_mark_color}}.container:hover input~.checkmark{background-color:${this.theme.input_checkbox_hover}}.container input:checked~.checkmark{background-color:${this.theme.input_checkbox_active_color}}.checkmark:after{content:"";position:absolute;display:none}.container input:checked~.checkmark:after{display:block}.container .checkmark:after{left:9px;top:5px;width:5px;height:10px;border:solid #fff;border-width:0 3px 3px 0;-webkit-transform:rotate(45deg);-ms-transform:rotate(45deg);transform:rotate(45deg)}</style><label class="container"><slot name="label"><ut-p>${this.config.placeholder}</ut-p></slot><input type="checkbox" value="${this.checkValue}" ?disabled="${this.disabled}" @click="${this.haveChanged}" ?checked="${e[this.config.name]===this.checkValue}"> <span class="checkmark"></span></label>`}}!function(e){e[e.SHOW_DATE=0]="SHOW_DATE",e[e.SHOW_MONTH=1]="SHOW_MONTH",e[e.SHOW_YEAR=2]="SHOW_YEAR"}(O||(O={}));class Ke extends t{constructor(e){super((()=>{const t=new Date(e.init_date).getFullYear();if(t>=e.minYear&&t<=e.maxYear){let t=new Date(e.init_date);return{date:t.getDate(),month:t.getMonth(),year:t.getFullYear(),status:O.SHOW_DATE}}throw"Init Date must be between min and max"})()),this.config=e,this._name="DatePickerBloc",this.isDirty=!1}get placeholder(){return this.config.placeholder}show_months(){this.emit({...this.state,status:O.SHOW_MONTH})}show_years(){this.emit({...this.state,status:O.SHOW_YEAR})}show_dates(){this.emit({...this.state,status:O.SHOW_DATE})}select_date(e){this.isDirty=!0,this.emit({...this.state,date:e})}select_month(e){this.isDirty=!0,this.emit({...this.state,month:e,status:O.SHOW_DATE})}select_year(e){this.isDirty=!0,this.emit({...this.state,year:e,status:O.SHOW_DATE})}convertDateToState(e){let t={...this.state};return t.date=e.getDate(),t.month=e.getMonth(),t.year=e.getFullYear(),t}postDateToForm(e){this.isDirty=!0;let t=new Date;t.setDate(this.state.date),t.setMonth(this.state.month),t.setFullYear(this.state.year);let i=ve.search("FormMessageBloc",e);_e.search(this.config.formBlocName,e).delegateChangeTo(this.config.nameForThisInForm,t.getTime(),i),this.emit(this.convertDateToState(t))}get dates_of_current_month(){const e=new Date(this.state.year,this.state.month+1,0);return[...Array(e.getDate()).keys()].map((e=>e+1))}get day_pattern_for_month(){const e=[0,1,2,3,4,5,6],t=this.first_day_of_month.getDay(),i=e.splice(0,t);return e.concat(i).map((e=>Ke.DayMap[e]))}get date_obj(){return new Date(this.state.year,this.state.month,this.state.date)}get first_day_of_month(){const e=this.date_obj,t=e.getFullYear(),i=e.getMonth();return new Date(t,i,1)}get last_day_of_month(){const e=this.date_obj,t=e.getFullYear(),i=e.getMonth();return new Date(t,i+1,0)}get month_list(){return[0,1,2,3,4,5,6,7,8,9,10,11]}get year_list(){const e=this.config.maxYear-this.config.minYear;return[...Array(e).keys()].map((e=>e+this.config.minYear))}}Ke.DayMap={0:"SUN",1:"MON",2:"TUE",3:"WED",4:"THU",5:"FRI",6:"SAT"},Ke.MonthMap={0:"JAN",1:"FEB",2:"MAR",3:"APR",4:"MAY",5:"JUN",6:"JUL",7:"AUG",8:"SEP",9:"OCT",10:"NOV",11:"DEC"};customElements.define("date-picker-body",class extends y{constructor(){super("DatePickerBloc")}builder(e){var t,i,s,r;switch(e.status){case O.SHOW_DATE:return o`<style>.container{display:grid;font-family:monospace;grid-template-columns:auto auto auto auto auto auto auto}.date{width:3em;height:3em;text-align:center;display:flex;justify-content:center;align-items:center}.day{background-color:${this.theme.primaryColor};color:#fff;text-align:center}.dayheader{padding:10px 0}.selected{background-color:${this.theme.primaryColor};border-radius:${this.theme.cornerRadius};color:#fff;font-weight:700;text-shadow:0 0 2px #fff}</style><lay-them in="column" ma="flex-start" ca="stretch"><div class="container">${null===(t=this.bloc)||void 0===t?void 0:t.day_pattern_for_month.map((e=>o`<div class="day dayheader">${e}</div>`))}</div><div class="container">${null===(i=this.bloc)||void 0===i?void 0:i.dates_of_current_month.map((t=>o`<div class="${t===e.date?"date selected":"date"}" @click="${()=>{var e;null===(e=this.bloc)||void 0===e||e.select_date(t)}}">${t}</div>`))}</div></lay-them>`;case O.SHOW_MONTH:return o`<style>.container{display:grid;font-family:monospace;grid-template-columns:auto auto auto auto}.month{width:3em;height:3em;display:flex;justify-content:center;align-items:center}</style><lay-them in="column" ma="flex-start" ca="stretch"><div class="container">${null===(s=this.bloc)||void 0===s?void 0:s.month_list.map((e=>o`<div class="month" @click="${()=>{var t;null===(t=this.bloc)||void 0===t||t.select_month(e)}}">${Ke.MonthMap[e]}</div>`))}</div></lay-them>`;case O.SHOW_YEAR:return o`<style>.container{display:grid;font-family:monospace;grid-template-columns:auto auto auto auto auto;max-height:300px}.year{padding:10px;display:flex;justify-content:center;align-items:center}.bold{font-weight:700}</style><lay-them in="column" ma="flex-start" ca="stretch"><div class="container">${null===(r=this.bloc)||void 0===r?void 0:r.year_list.map((e=>{let t="year";return e%5==0&&(t+=" bold"),o`<div class="${t}" @click="${()=>{var t;null===(t=this.bloc)||void 0===t||t.select_year(e)}}">${e}</div>`}))}</div></lay-them>`}}});customElements.define("date-picker-ok-button",class extends xe{onPress(){var e;const t=Ke.search("DatePickerBloc",this);null==t||t.postDateToForm(this),null===(e=this.bloc)||void 0===e||e.toggle()}constructor(){super("HideBloc")}});customElements.define("date-picker-modal",class extends y{constructor(){super("DatePickerBloc")}get date(){return this._date}set date(e){if(this._date=e,e){let e=new Date;if(e.setTime(this.date),this.bloc){let t=this.bloc.convertDateToState(e);this.bloc.isDirty=!0,this.bloc.emit(t)}}}connectedCallback(){super.connectedCallback(),setTimeout((()=>{if(this.bloc&&this.date){let e=new Date;e.setTime(this.date);let t=this.bloc.convertDateToState(e);this.bloc.isDirty=!0,this.bloc.emit(t)}}),300)}builder(e){var t;return o`<style>.selectButton{background-color:${this.theme.primaryColor};padding:10px;color:#fff;flex:1;text-align:center}.header{z-index:10;padding:10px;background-color:${this.theme.primaryColor};border-radius:${this.theme.cornerRadius};${this.theme.cornerRadius}font-size:1.2em;box-shadow:0 20px 20px 0 #00000021}</style><ut-ex><div style="height:100%;background-color:#fff;border-radius:${this.theme.cornerRadius}"><lay-them in="column" ma="flex-start" ca="stretch"><div class="header">${null===(t=this.bloc)||void 0===t?void 0:t.placeholder}</div><div class="date_year_button"><lay-them in="row" ma="space-between"><div class="selectButton" @click="${()=>{var e;null===(e=this.bloc)||void 0===e||e.show_months()}}">${Ke.MonthMap[e.month]}</div><div class="selectButton" @click="${()=>{var e;null===(e=this.bloc)||void 0===e||e.show_years()}}">${e.year}</div></lay-them></div><div><date-picker-body></date-picker-body></div><div style="padding-top:10px"><date-picker-ok-button use="background-color: ${this.theme.primaryColor};"><lay-them ma="center" ca="center"><ut-icon icon="done" use="icon_inactive:white;"></ut-icon></lay-them></date-picker-ok-button></div></lay-them></div></ut-ex>`}});customElements.define("date-picker-input",class extends y{convert_sate_to_date_string(e){return o`${e.date}-${Ke.MonthMap[e.month]}-${e.year}`}builder(e){return o`<div style="width:100%;height:100%" @click="${()=>{navigator.vibrate(v.PRESS_VIB);let e=B.search("HideBloc",this);null==e||e.toggle()}}">${(()=>{var t,i;return e&&(null===(t=this.bloc)||void 0===t?void 0:t.isDirty)?o`<lay-them in="row" ma="space-between" ca="center"><div style="padding:0 10px">${this.convert_sate_to_date_string(e)}</div><div style="padding:0 10px"><ut-icon icon="today"></ut-icon></div></lay-them><slot></slot>`:o`<lay-them in="row" ma="space-between" ca="center"><div style="color:grey;padding:0 10px">${null===(i=this.bloc)||void 0===i?void 0:i.placeholder}</div><div style="padding:0 10px"><ut-icon icon="today" use="icon_inactive: #a7a7a7;"></ut-icon></div></lay-them><slot></slot>`})()}</div>`}constructor(){super("DatePickerBloc")}});class Je extends y{constructor(e,t){super(e.bloc_name,{blocs_map:{HideBloc:new B(!0,`date_picker_${e.name}`),DatePickerBloc:new Ke(t)}}),this.formInputConfig=e}builder(e){return o`<div style="width:100%;height:40px;border-radius:4px;background-color:#e6e6e6;font-family:monospace;user-select:none"><date-picker-input><ut-dialogue><lay-them ma="center" ca="center"><date-picker-modal .date="${e[this.formInputConfig.name]}"></date-picker-modal></lay-them></ut-dialogue></date-picker-input></div>`}}class et extends be{constructor(e){super(e),this.value={start:0,end:0},this.isDraging=!1,this._drag_ON=e=>{this.isDraging=!0,navigator.vibrate(v.PRESS_VIB)},this._drag_OFF=e=>{this.isDraging=!1,navigator.vibrate(0)},this._drag=e=>{if(this.isDraging){let t=this.posMin+this.handleRadius,i=this.posMax-this.handleRadius;e<t?e=t:e>i&&(e=i)}else console.log("no drag on");return e},this._start_drag=e=>{if(!this.disabled){let t=e.changedTouches[0].clientX;t=this._drag(t),t>this.posEnd&&(t=this.posEnd-2*this.handleRadius);let i=this.posMax-3*this.handleRadius;t>=i&&(t=i),this.setStartPos(t),this.setActiveStart(t),this._postChange()}},this._end_drag=e=>{if(!this.disabled){let t=e.changedTouches[0].clientX;t=this._drag(t),t<this.posStart&&(t=this.posStart+2*this.handleRadius);let i=this.posMin+3*this.handleRadius;t<=i&&(t=i),this.setEndPos(t),this.setActiveEnd(t),this._postChange()}},this._start_dragHandler={handleEvent:this._start_drag,passive:!0},this._end_dragHandler={handleEvent:this._end_drag,passive:!0},this.posMax=0,this.posMin=0,this.posStart=0,this.posEnd=0,this.width=0;let t=e.rangeSelectorConfig?`${e.rangeSelectorConfig.range.end}`:this.getAttribute("max"),i=e.rangeSelectorConfig?`${e.rangeSelectorConfig.range.start}`:this.getAttribute("min");if(this.handleRadius=12,!t||!i)throw"Not all attributes provided for a range selector: min and max";this.max=Number(t),this.min=Number(i);let s=e.rangeSelectorConfig?"true":this.getAttribute("isint");this.isint=!!s,this.start_color=this.theme.primaryColor,this.end_color=this.theme.secondaryColor,this.base_color=this.theme.input_bg_color}builder(e){var t,i,s;return this.disabled?(this.start_color=this.base_color,this.end_color=this.base_color):(this.start_color=this.theme.primaryColor,this.end_color=this.theme.secondaryColor),o`<style>.no-select{user-select:none}</style>${(null===(t=this.config.rangeSelectorConfig)||void 0===t?void 0:t.no_label)?o``:o`<lay-them in="row" ma="center"><div class="no-select" style="font-weight:700;font-size:${this.theme.H3_font_size}">${this.isint?this.value.start:this.value.start.toFixed(2)}</div></lay-them>`} <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="100%" height="50px" version="1.1" id="svg8"><defs id="defs2"><linearGradient id="linearGradient1197"><stop style="stop-color:${this.end_color};stop-opacity:1" offset="0" id="stop1193"/><stop style="stop-color:${this.start_color};stop-opacity:1" offset="1" id="stop1195"/></linearGradient><filter style="color-interpolation-filters:sRGB" id="filter1157"><feFlood flood-opacity="0.666667" flood-color="rgb(0,0,0)" result="flood" id="feFlood1147"/><feComposite in="flood" in2="SourceGraphic" operator="in" result="composite1" id="feComposite1149"/><feGaussianBlur in="composite1" stdDeviation="0.989644" result="blur" id="feGaussianBlur1151"/><feOffset dx="0" dy="0" result="offset" id="feOffset1153"/><feComposite in="SourceGraphic" in2="offset" operator="over" result="composite2" id="feComposite1155"/></filter><linearGradient xlink:href="#linearGradient1197" id="linearGradient1199" x1="13.141692" y1="15.874999" x2="500" y2="15.874999" gradientUnits="userSpaceOnUse"/><filter style="color-interpolation-filters:sRGB" id="filter1261" height="1.6700000000000004" width="1.5700000000000003" x="-0.30000000000000016" y="-0.30000000000000016"><feFlood flood-opacity="0.666667" flood-color="rgb(0,0,0)" result="flood" id="feFlood1251"/><feComposite in="flood" in2="SourceGraphic" operator="in" result="composite1" id="feComposite1253"/><feGaussianBlur in="composite1" stdDeviation="4.58947" result="blur" id="feGaussianBlur1255"/><feOffset dx="0" dy="0" result="offset" id="feOffset1257"/><feComposite in="SourceGraphic" in2="offset" operator="over" result="composite2" id="feComposite1259"/></filter></defs><metadata id="metadata5"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g id="layer1"><rect style="fill:${this.base_color};stroke-width:.477727;stroke-linejoin:round;stroke-opacity:.658819" id="base" width="100%" height="5" x="0" y="20"/><path id="acrange" style="fill:url(#linearGradient1199)" d="" id="path833"/><circle style="fill:${this.end_color};stroke:#fff;stroke-width:4;display:${(null===(i=this.config.rangeSelectorConfig)||void 0===i?void 0:i.no_start)?"none":"block"}" id="start-handle" cy="25" r="${this.handleRadius}" @touchstart="${this._drag_ON}" @touchend="${this._drag_OFF}" @touchmove="${this._start_dragHandler}"/><circle style="fill:${this.start_color};stroke:#fff;stroke-width:4" id="end-handle" cy="25" r="${this.handleRadius}" @touchstart="${this._drag_ON}" @touchend="${this._drag_OFF}" @touchmove="${this._end_dragHandler}/"></circle></g></svg> ${(null===(s=this.config.rangeSelectorConfig)||void 0===s?void 0:s.no_label)?o``:o`<lay-them in="row" ma="space-between"><div class="no-select"><ut-p>${this.min}</ut-p></div><div class="no-select" style="font-weight:700;font-size:${this.theme.H3_font_size}">${this.isint?this.value.end:this.value.end.toFixed(2)}</div><div class="no-select"><ut-p>${this.max}</ut-p></div></lay-them>`}`}_postChange(){let e=this.positionToValue(this.posEnd),t=this.positionToValue(this.posStart);this.isint&&(e=Math.floor(e),t=Math.floor(t)),t<this.min&&(t=this.min),this.value={start:t,end:e},this.hasChanged(this.value)}valueToPercentage(e){return(e-(this.min+this.handleRadius/this.width))/(this.max-this.min-2*this.handleRadius/this.width)*100}percentageToPosition(e){return this.handleRadius+e*(this.posMax-this.posMin-2*this.handleRadius)/100}positionToValue(e){return this.min+(this.max-this.min)/(this.width-2*this.handleRadius)*(e-this.handleRadius)}connectedCallback(){var e,t,i,s,o,r,a;if(super.connectedCallback(),this.start=null===(e=this.bloc)||void 0===e?void 0:e.state[this.config.name].start,this.end=null===(t=this.bloc)||void 0===t?void 0:t.state[this.config.name].end,!(0==this.start||this.start&&this.start>=0&&0==this.end||this.end&&this.end>=0))throw`No start and end provided for range selector in form initialization for : ${this.config.name}`;if(this.start>this.end)throw`For a range selector start cannot be less then end value, please check initialization of rang selector: ${this.config.name}`;if(this.start<this.min)throw`Start ${this.start} cannot be less than min value ${this.min}, check form init values for this range selector`;if(this.end>this.max)throw`End ${this.end} cannot be more than max value ${this.max}, check form init values for this range selector`;let n=null===(s=null===(i=this.shadowRoot)||void 0===i?void 0:i.querySelector("#svg8"))||void 0===s?void 0:s.clientWidth,l=null===(r=null===(o=this.shadowRoot)||void 0===o?void 0:o.querySelector("#svg8"))||void 0===r?void 0:r.clientLeft;this.posMin=l,this.posMax=n+this.posMin,this.width=this.posMax-this.posMin;let c=this.percentageToPosition(this.valueToPercentage(this.start));this.setStartPos(c);let h=this.percentageToPosition(this.valueToPercentage(this.end));this.setEndPos(h),this.value={start:this.start,end:this.end},null===(a=this.bloc)||void 0===a||a.emit({...this.bloc.state}),this.setActiveStart(c)}setStartPos(e){var t,i;null===(i=null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelector("#start-handle"))||void 0===i||i.setAttribute("cx",`${e}`),this.posStart=e}setActiveStart(e){var t,i;let s=this.posEnd-this.posStart,o=`m ${e},20 h ${s} v 5 h -${s} z`;null===(i=null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelector("#acrange"))||void 0===i||i.setAttribute("d",o)}setActiveEnd(e){var t,i;let s=this.posStart-this.posMin,o=`m ${s},20 h ${e-s} v 5 h ${s-e} z`;null===(i=null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelector("#acrange"))||void 0===i||i.setAttribute("d",o)}setEndPos(e){var t,i;null===(i=null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelector("#end-handle"))||void 0===i||i.setAttribute("cx",`${e}`),this.posEnd=e}}class tt extends be{constructor(e){super(e),this.toggle=e=>{var t;e.preventDefault();let i=null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelector("label > input[type=checkbox]"),s=i.checked;return i.checked=!s,this.hasChanged(!s),!1}}builder(e){return o`<style>.switch{position:relative;display:inline-block;width:60px;height:34px}.switch input{opacity:0;width:0;height:0}.slider{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:#ccc;-webkit-transition:.4s;transition:.4s}.slider:before{position:absolute;content:"";height:26px;width:26px;left:4px;bottom:4px;background-color:#fff;-webkit-transition:.4s;transition:.4s}input:checked+.slider{background-color:${this.theme.toggleButtonOnColor}}input:focus+.slider{box-shadow:0 0 1px ${this.theme.toggleButtonOnColor}}input:checked+.slider:before{-webkit-transform:translateX(26px);-ms-transform:translateX(26px);transform:translateX(26px)}.slider.round{border-radius:34px}.slider.round:before{border-radius:50%}</style><label class="switch" @click="${this.toggle}"><input type="checkbox" ?checked="${e[this.config.name]}"> <span class="slider round"></span></label>`}}!function(e){e[e.INIT=0]="INIT",e[e.NEW_IMAGE=1]="NEW_IMAGE",e[e.DRAW=2]="DRAW",e[e.GIVE_IMAGE=3]="GIVE_IMAGE"}(R||(R={})),function(e){e[e.NEW_IMAGE=0]="NEW_IMAGE",e[e.ZOOM=1]="ZOOM",e[e.PAN=2]="PAN",e[e.BRIGHTNESS=3]="BRIGHTNESS",e[e.CONTRAST=4]="CONTRAST"}(D||(D={}));class it extends i{constructor(e){super({}),this.config=e,this.tags_list={},this.defineTags()}convertNameToInputTagName(e){return`${this.config.tag_prefix}-${e.toLowerCase()}-input`}defineTags(){this.nameList=Object.keys(this.config.inputs);for(let e of this.nameList){let t=this.convertNameToInputTagName(e),i=this.config.inputs[e];switch(i.type){case"SingleLineInput":{class e extends He{constructor(){super(i.config)}}customElements.get(t)||customElements.define(t,e);break}case"TextAreaInput":{class e extends Ge{constructor(){super(i.config)}}customElements.get(t)||customElements.define(t,e);break}case"CheckBox":{class e extends Qe{constructor(){super(i.config,i.input_init_values)}}customElements.get(t)||customElements.define(t,e);break}case"DatePicker":{class e extends Je{constructor(){super(i.config,i.input_init_values)}}customElements.get(t)||customElements.define(t,e);break}case"RadioButtons":{class e extends Xe{constructor(){super(i.config,i.input_init_values)}}customElements.get(t)||customElements.define(t,e);break}case"RangeSelector":{class e extends et{constructor(){super(i.config)}}customElements.get(t)||customElements.define(t,e);break}case"ToggleButton":{class e extends tt{constructor(){super(i.config)}}customElements.get(t)||customElements.define(t,e)}}this.tags_list[e]=t}}builder(){return o`<style>.input{padding:10px 10px 0 10px}.button{padding:20px 10px}.input-msg{font-size:.8em;color:red}label{color:var(--label-color,#000);user-select:none}</style>${c(this.nameList,(e=>e),((e,t)=>o`<div class="input"><label for="${e}"><ut-h5 .key="${this.config.inputs[e].label}" use="color:var(--label-color,#000);"></ut-h5>:<ut-h5 use="color:var(--input-info-msg-color,#8a8a8a);" .key="${this.config.inputs[e].input_info_msg}"></ut-h5></label> ${n(`<${this.tags_list[e]}></${this.tags_list[e]}>`)}<div class="input-msg"><form-message for="${e}"></form-message></div></div>`))}`}}class st extends B{constructor(){super(...arguments),this.blobIndex=0,this._name="ImageEditorHideBloc",this.imageEditorWorker=(()=>{let e=new Worker("/js/use-them/image-editor.js");return e.onmessage=e=>{this.imageEditedListener(e.data.blob,this.blobIndex)},e})()}get fileName(){return this._fileName}onConnection(e){super.onConnection(e);let t=this.canvas.transferControlToOffscreen(),i={type:R.INIT,value:t};this.imageEditorWorker.postMessage(i,[t])}onDisconnection(){this.imageEditorWorker.terminate()}getInitValue(){var e;let t=v.IMAGE_EDIT_OP_DEFAULT_SIZE,i=this.hostElement.getAttribute("iesize");i&&(t=null!==(e=parseInt(i))&&void 0!==e?e:v.IMAGE_EDIT_OP_DEFAULT_SIZE);return{brightness:0,contrast:0,movement:{x:0,y:0},axis:{x:0,y:0},zoom:1,newImageConfig:{baseDimension:{x:t,y:t},opMaxLength:t,origBlob:this.blob},draw_purpose:D.NEW_IMAGE}}get canvas(){var e;return this._canvas||(this._canvas=null===(e=this.hostElement.shadowRoot)||void 0===e?void 0:e.querySelector("#output")),this._canvas}get blob(){return this._blob}set blob(e){this._blob=e,this.initDraw()}initDraw(){var e;null===(e=ot.search("ImageEditorFormBloc",this.hostElement))||void 0===e||e.resetForm();let t=this.getInitValue();this.draw(t,R.NEW_IMAGE),delete t.newImageConfig}editImage({index:e,blob:t,fileName:i,imageEditedListener:s}){this.blobIndex=e,this._fileName=i,this.imageEditedListener=s,this.blob=t}draw(e,t=R.DRAW){this.currentValue=e;let i={type:t,value:e};this.imageEditorWorker.postMessage(i)}setBrightness(e){this.draw({...this.currentValue,brightness:e,draw_purpose:D.BRIGHTNESS,movement:{x:0,y:0}})}setContrast(e){this.draw({...this.currentValue,contrast:e,draw_purpose:D.CONTRAST,movement:{x:0,y:0}})}acceptImage(){this.imageEditorWorker.postMessage({type:R.GIVE_IMAGE})}onPan(e,t){this.currentValue.movement=e,this.currentValue.axis=t,this.currentValue.draw_purpose=D.PAN,this.draw(this.currentValue)}onZoom(e,t){let i=e;e>1+v.IMAGE_EDIT_ZOOM_SENSITIVITY?i=1+v.IMAGE_EDIT_ZOOM_SENSITIVITY:e<1-v.IMAGE_EDIT_ZOOM_SENSITIVITY&&(i=1-v.IMAGE_EDIT_ZOOM_SENSITIVITY),this.currentValue.movement={x:0,y:0},this.currentValue.zoom=i,this.currentValue.axis=t,this.currentValue.draw_purpose=D.ZOOM,this.draw(this.currentValue)}}customElements.define("ut-image-editor",class extends y{constructor(){super("ImageEditorHideBloc",{blocs_map:{ImageEditorHideBloc:new st(!0,"ImageEditorHideBloc"),ImageEditorFormBloc:new ot,FormMessageBloc:new ve}}),this.hideEditor=e=>{var t;null===(t=this.bloc)||void 0===t||t.toggle()},this.acceptImage=e=>{var t,i;null===(t=this.bloc)||void 0===t||t.acceptImage(),null===(i=this.bloc)||void 0===i||i.toggle()}}connectedCallback(){super.connectedCallback(),k.add("ImageEditorHideBloc",this.blocBuilderConfig.blocs_map.ImageEditorHideBloc)}get zapBlocBuilderConfig(){let e=this.bloc;return{blocs_map:{ZoomAndPanBloc:new class extends De{constructor(){super(0),this.onZoom=(t,i)=>{null==e||e.onZoom(t,i)},this.onPan=(t,i)=>{null==e||e.onPan(t,i)},this._name="ZoomAndPanBloc"}onDoublePointTouch(e){}onPointRelease(e){}onPointTouch(e){}}}}}get iesize(){let e=this.getAttribute("iesize");return e||(e="800px"),e}builder(e){var t;return o`
            <style>
                .cont{
                    display:${e?"none":"block"};
                    position:fixed;
                    top:0px;
                    width:100%;
                    height:100%;
                    background-color: #000000c7;
                    z-index: 3;
                    backdrop-filter: blur(2px);
                }
                .title{
                    color: white;
                    padding: 5px 20px;
                    text-align: center;
                    user-select:none;
                }
                .output{
                    width: 300px;
                    height: 300px;
                    border: 1px solid #ffffff54;
                }
                .opCont{
                    display: flex;
                    justify-content: center;
                    padding: 0px 12px;
                }
                .padH20{
                    padding: 0px 20px;
                }
                .pad20{
                    padding: 20px;
                }
            </style>
            <div class="cont">
                <lay-them in="column" ma="space-between" ca="stretch">
                    <!-- <div class="title">${null===(t=this.bloc)||void 0===t?void 0:t.fileName}</div> -->
                    <div class="opCont">
                        <ut-pan-zoom-detector bloc="ZoomAndPanBloc" .blocBuilderConfig=${this.zapBlocBuilderConfig}>
                            <canvas class="output" width=${this.iesize} height=${this.iesize} id="output"></canvas>
                        </ut-pan-zoom-detector>
                    </div>
                    <div class="padH20">
                        ${e?o``:o`<ut-ie-inputs style="--label-color:white;"></ut-ie-inputs>`}
                    </div>
                    <div class="pad20">
                        <lay-them in="row" ma="space-between">
                            <circular-icon-button use="icon:done;primaryColor:white;" style="--bg-color:black;" @click=${this.acceptImage}></circular-icon-button>
                            <circular-icon-button use="icon:clear;primaryColor:white;" style="--bg-color:black;" @click=${this.hideEditor}></circular-icon-button>
                        </lay-them>
                    </div>
                </lay-them>
            </div>`}});class ot extends _e{constructor(){super({brightness:{start:0,end:v.IMAGE_EDIT_MID_RANGE},contrast:{start:0,end:v.IMAGE_EDIT_MID_RANGE}}),this._name="ImageEditorFormBloc"}get editorBloc(){if(!this._editorBloc){let e=st.search("ImageEditorHideBloc",this.hostElement);this._editorBloc=e}return this._editorBloc}resetForm(){this.emit({brightness:{start:0,end:v.IMAGE_EDIT_MID_RANGE},contrast:{start:0,end:v.IMAGE_EDIT_MID_RANGE}})}validatorFunctionGiver(e){}postOnChangeFunctionGiver(e){return"brightness"===e?e=>{this.editorBloc.setBrightness(e.end-v.IMAGE_EDIT_MID_RANGE)}:"contrast"===e?e=>{this.editorBloc.setContrast(e.end-v.IMAGE_EDIT_MID_RANGE)}:void 0}}customElements.define("ut-ie-inputs",class extends it{constructor(){super({formBloc_name:"ImageEditorFormBloc",tag_prefix:"ut-ie",inputs:{brightness:{type:"RangeSelector",config:{bloc_name:"ImageEditorFormBloc",name:"brightness",rangeSelectorConfig:{range:{end:2*v.IMAGE_EDIT_MID_RANGE,start:0},isint:!0,no_label:!0,no_start:!0}},label:"Brightness"},contrast:{type:"RangeSelector",config:{bloc_name:"ImageEditorFormBloc",name:"contrast",rangeSelectorConfig:{range:{end:2*v.IMAGE_EDIT_MID_RANGE,start:0},isint:!0,no_label:!0,no_start:!0}},label:"Contrast"}}})}});class rt extends y{builder(e){return o`<div style="height:60px"><lay-them in="stack"><div style="width:100%;height:100%"><slot name="appbar-bg"><svg version="1.1" viewBox="0 0 100 100" preserveAspectRatio="none" height="100%" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><linearGradient id="linearGradient850" x1="-28.773" x2="119.68" y1="53.936" y2="50.846" gradientUnits="userSpaceOnUse"><stop stop-color="${this.theme.secondaryColor}" offset="0"></stop><stop stop-color="${this.theme.primaryColor}" offset="1"></stop></linearGradient></defs><rect width="100" height="100" fill="url(#linearGradient850)" stroke-linejoin="round" stroke-width="2.1354"></rect></svg></slot></div><div style="width:100%;height:100%"><lay-them in="row" ma="flex-start" ca="stretch"><div @click="${()=>{U.search("AppPageBloc",this).popOutOfCurrentPage()}}"><lay-them ma="center" ca="center"><div style="padding:0 10px"><ut-icon icon="chevron-left" use="icon_inactive: #fff;"></ut-icon></div></lay-them></div><div style="flex:1"><lay-them in="row" ca="center" ma="flex-start"><ut-p use="color: white;">${this.title}</ut-p></lay-them></div></lay-them></div></lay-them></div>`}constructor(){super("AppPageBloc")}}customElements.get("title-bar-with-back-button")||customElements.define("title-bar-with-back-button",rt);class at extends x{builder(e){return o`<lay-them in="column" ma="flex-start" ca="stretch" overflow="hidden"><title-bar-with-back-button title="${this.title}" use="${this.getAttribute("use")}" style="box-shadow:0 0 4px;z-index:2"></title-bar-with-back-button><div class="body" style="flex:1 1 auto;overflow-y:auto"><slot></slot></div></lay-them>`}}customElements.get("backable-screen")||customElements.define("backable-screen",at);class nt extends t{}!function(e){e[e.INIT=0]="INIT",e[e.CAMERA_LIVE=1]="CAMERA_LIVE",e[e.NO_DEVICE_MEDIA=2]="NO_DEVICE_MEDIA",e[e.SCANNER_NOT_SUPPORTED=3]="SCANNER_NOT_SUPPORTED"}(M||(M={}));class lt extends t{constructor(){super({status:M.INIT}),this._name="QrCodeScannerBloc",this.torch_on=!1,this.scan=async()=>{var e;if("BarcodeDetector"in window){let t=this.hostElement.qrConfig,i=new BarcodeDetector({formats:null!==(e=null==t?void 0:t.formats)&&void 0!==e?e:["qr_code","ean_13"]});if(this.video_el){let e=await i.detect(this.video_el);if(e.forEach((e=>{this.state.codes||(this.state.codes=[]),this.state.codes.push(e),this.emit({...this.state,codes:[...this.state.codes]})})),e.length>0&&(null==t?void 0:t.sound_url)){let e=new Audio(t.sound_url);await e.play()}}}else this.emit({status:M.SCANNER_NOT_SUPPORTED})},this.postQrCode=()=>{var e,t,s;let o=i.search(null!==(s=null===(t=null===(e=this.hostElement)||void 0===e?void 0:e.qrConfig)||void 0===t?void 0:t.notify_bloc_name)&&void 0!==s?s:"QrCodeListenerBloc",this.hostElement);o&&o.user_selected_qr_codes(this.state.codes),this.close()},this.close=()=>{var e;null===(e=i.search("QrCodeHideBloc",this.hostElement))||void 0===e||e.toggle()},this.toggle_torch=()=>{var e;this.torch_on=!this.torch_on,null===(e=this.videoStream)||void 0===e||e.getTracks()[0].applyConstraints({advanced:[{torch:this.torch_on}]})}}async init(){var e,t;try{this.emit({status:M.CAMERA_LIVE}),this.videoStream=await navigator.mediaDevices.getUserMedia({video:{width:1280,height:720,facingMode:{exact:"environment"}},audio:!1}),this.video_el=null===(t=null===(e=this.hostElement)||void 0===e?void 0:e.shadowRoot)||void 0===t?void 0:t.querySelector("#video_el"),this.video_el.srcObject=this.videoStream,this.video_el.onloadeddata=e=>{var t;null===(t=this.video_el)||void 0===t||t.play()}}catch(e){this.emit({status:M.NO_DEVICE_MEDIA})}}close_camera(){if(this.video_el){this.video_el.srcObject.getTracks().forEach((e=>{e.stop()})),this.video_el.srcObject=null}}}customElements.define("ut-qr-code-camera-stream",class extends y{constructor(){super("QrCodeScannerBloc",{blocs_map:{QrCodeScannerBloc:new lt}})}connectedCallback(){super.connectedCallback(),setTimeout((()=>{var e;null===(e=this.bloc)||void 0===e||e.init()}),200)}disconnectedCallback(){var e;null===(e=this.bloc)||void 0===e||e.close_camera(),super.disconnectedCallback()}builder(e){var t,i,s,r,a,n,l,c,h;return e.status===M.NO_DEVICE_MEDIA?o`<style>.cont{padding:10px;height:100px;min-width:200px}</style><div class="cont"><lay-them in="column" ma="space-around" ca="stretch"><div style="text-align:center"><ut-p use="color:white">no_camera_found</ut-p></div><div @click="${null===(t=this.bloc)||void 0===t?void 0:t.close}"><labeled-icon-button icon="clear" label="close" use="primaryColor:white;color:white;"></labeled-icon-button></div></lay-them></div>`:e.status===M.INIT?o`<style>.cont{padding:10px;height:100px;min-width:200px}</style><div class="cont"><lay-them in="column" ma="space-around" ca="stretch"><div style="text-align:center"><ut-p use="color:white">camera_permission</ut-p></div><div @click="${null===(i=this.bloc)||void 0===i?void 0:i.close}"><labeled-icon-button icon="clear" label="close" use="primaryColor:white;color:white;"></labeled-icon-button></div></lay-them></div>`:e.status===M.SCANNER_NOT_SUPPORTED?o`<ut-p use="color:white">qr_scanner_not_supported</ut-p>`:o`<style>.tool{z-index:12;position:absolute;min-width:50px;min-height:50px}.count{top:10px;left:10px;color:#fff;background-color:#00000061;border-radius:50%;width:30px;height:30px;display:flex;justify-content:center;align-content:center;align-items:center}</style><div style="position:relative;display:flex;align-content:center;justify-content:center"><div class="tool count" style="top:10px;left:10px">${null!==(a=null===(r=null===(s=this.state)||void 0===s?void 0:s.codes)||void 0===r?void 0:r.length)&&void 0!==a?a:0}</div><div class="tool" style="top:10px;right:10px" @click="${null===(n=this.bloc)||void 0===n?void 0:n.close}"><labeled-icon-button icon="clear" label="close" use="primaryColor:white;color:white;"></labeled-icon-button></div><div class="tool" style="bottom:10px;right:10px" @click="${null===(l=this.bloc)||void 0===l?void 0:l.postQrCode}"><labeled-icon-button icon="done" label="ok" use="primaryColor:white;color:white;"></labeled-icon-button></div><div class="tool" style="bottom:10px" @click="${null===(c=this.bloc)||void 0===c?void 0:c.scan}"><labeled-icon-button icon="qrcode" label="scan" use="primaryColor:white;color:white;"></labeled-icon-button></div><div class="tool" style="bottom:10px;left:10px" @click="${null===(h=this.bloc)||void 0===h?void 0:h.toggle_torch}"><labeled-icon-button icon="highlight" label="torch" use="primaryColor:white;color:white;"></labeled-icon-button></div><div><video style="max-width:95vw;max-height:95vh" autoplay muted id="video_el"></video></div></div>`}});customElements.define("ut-qr-code-widget",class extends y{constructor(){super("QrCodeHideBloc")}builder(e){return e?o``:o`<style>.fullscreenGlass{position:fixed;width:100%;height:100%;background-color:${this.theme.dialogue_bg};display:block;z-index:10;top:0;left:0}.camera_preview{max-width:95vw;max-height:95vh;background-color:#00000042;color:#fff}.close_button{position:absolute;top:10px;right:10px;width:50px;height:50px;z-index:11}</style><div class="fullscreenGlass"><lay-them ma="center" ca="center"><div class="camera_preview"><ut-qr-code-camera-stream .qrConfig="${this.qrConfig}"></ut-qr-code-camera-stream></div></lay-them></div>`}});class ct extends t{constructor(e,t=0){super(e[t].id),this.smartTabConfigs=e,this.index=t,this.indexExtent=this.smartTabConfigs.length-1}scrollTabIntoView(e){var t,i;let s=null===(i=null===(t=this.hostElement)||void 0===t?void 0:t.shadowRoot)||void 0===i?void 0:i.querySelector(`lay-them > div.tabs_bar > ink-well[tab_id='${e}']`);null==s||s.scrollIntoView()}goToNextTab(){this.index++,this.index>this.indexExtent&&(this.index=0);let e=this.smartTabConfigs[this.index].id;this.scrollTabIntoView(e),this.goToTab(e,this.index)}goToPrevTab(){this.index--,this.index<0&&(this.index=this.indexExtent);let e=this.smartTabConfigs[this.index].id;this.scrollTabIntoView(e),this.goToTab(e,this.index)}goToTab(e,t){var i;this.index=null!=t?t:this.smartTabConfigs.findIndex((t=>t.id===e)),this.emit(e),null===(i=this.onTabChangeCallBack)||void 0===i||i.call(this,e)}}customElements.define("ut-stb-gesture-detector",class extends Pe{constructor(){super(...arguments),this.onSwipeLeft=()=>{navigator.vibrate(v.PRESS_VIB),this.getStbBloc().goToNextTab()},this.onSwipeRight=()=>{navigator.vibrate(v.PRESS_VIB),this.getStbBloc().goToPrevTab()}}getStbBloc(){return this.stbBloc||(this.stbBloc=i.search("STB",this)),this.stbBloc}});class ht extends y{constructor(){super(...arguments),this.goToTab=e=>{var t;let i=e.currentTarget;null===(t=this.bloc)||void 0===t||t.goToTab(i.getAttribute("tab_id"))}}builder(e){var t;let i=o`${null===(t=this.bloc)||void 0===t?void 0:t.smartTabConfigs.map((t=>o`<ink-well tab_id="${t.id}" @click="${this.goToTab}"><div class="tab_icon"><div><ut-icon icon="${t.icon}"></ut-icon></div><div class="tab-text">${e===t.id?o`<ut-h5 .key="${t.label}" style="padding-left:5px"></ut-h5>`:r}</div></div></ink-well>`))}`,s=this.bloc.builderForId(e,this);return o`<style>.tabs_bar{height:50px;width:100%;display:flex;overflow-x:auto}.tab_icon{max-height:50px;display:flex;align-items:center;padding:10px;justify-content:center}.tab-text{white-space:nowrap;max-width:60vw;overflow-x:hidden}</style><lay-them in="column" ma="flex-start" ca="stretch"><div class="tabs_bar">${i}</div><div style="flex-grow:1;height:0"><ut-stb-gesture-detector>${s}</ut-stb-gesture-detector></div></lay-them>`}}class dt{static create(e){let t={...e.blocs_map};t.STB=new class extends ct{constructor(){super(e.smartTabConfig,e.index),this.onTabChangeCallBack=e.onTabChangeCallBack,this.builderForId=e.builderForIdFunction,this._name="STB"}};class i extends ht{constructor(){super("STB",{blocs_map:t})}}customElements.get(e.tag_name)||customElements.define(e.tag_name,i)}}class ut{static create(e){class i extends t{constructor(){super(e.tabs_name_icon[0]),this._name="TagChangeBloc"}changeTab(e){this.emit(e)}}customElements.define(e.tag_name,class extends y{constructor(){super("TagChangeBloc",{blocs_map:{TagChangeBloc:new i}}),this.goToTab=e=>{var t;let i=e.currentTarget.getAttribute("tab_name");i&&(null===(t=this.bloc)||void 0===t||t.changeTab(i))}}builder(t){return o`<style>.vtxt{writing-mode:vertical-rl;text-orientation:mixed}.tab{padding:10px;background:${this.theme.vTab_inactiveColor}}.selected{background-color:${this.theme.vTab_activeColor}}.tab-body{flex:1}.tab-headers{height:100%}.filler{flex:1;background:${this.theme.vTab_inactiveColor}}</style><div style="width:100%l;height:100%"><lay-them in="row" ma="flex-start" ca="stretch"><div class="tab-body">${e.builder_function(t)}</div><div class="tab-headers"><lay-them in="column" ma="flex-start">${c(e.tabs_name_icon,(e=>e),((e,i)=>o`<ink-well tab_name="${e}" @click="${this.goToTab}"><div class="${t===e?"tab selected":"tab"}"><div><ut-icon icon="${e}" use="icon_inactive:${t===e?this.theme.vTab_active_icon_color:this.theme.vTab_inactive_icon_color};"></ut-icon></div><div class="vtxt">${e.toUpperCase()}</div></div></ink-well>`))}<div class="filler"></div></lay-them></div></lay-them></div>`}})}}class mt extends t{constructor(e){super(mt.calculatePercentage(e.initState,e.max)),this.percentConfig=e,this._name="PercentageBloc"}static calculatePercentage(e,t){return 100*e/t}set max(e){this.percentConfig.max=e}get max(){return this.percentConfig.max}update(e){this.emit(mt.calculatePercentage(e,this.percentConfig.max))}}class pt extends B{constructor(){super(!1)}get video(){return this._video}set video(e){this._video=e,this.video.muted=!0}get HideToolBarBloc(){return this._HideToolBarBloc||(this._HideToolBarBloc=this.getBloc("HideToolBarBloc")),this._HideToolBarBloc}play(){this.emit(!0);let e=this.video.play();return this.HideToolBarBloc.setTrue(),setTimeout((()=>{this.video.muted=!1}),300),e}isPlaying(){return this.state}isNotPlaying(){return!this.state}pause(){this.emit(!1),this.video.pause(),this.HideToolBarBloc.setFalse(),setTimeout((()=>{this.video.muted=!0}),300)}onDisconnection(){this.video&&(this.video.pause(),this.video.src="")}}class gt extends s{constructor(){super({blocs_map:{HideToolBarBloc:new B,ProgressBarBloc:new mt({initState:0,max:100}),VideoPlayerInView:new B(!1),VideoPlayControl:new pt,IsVideoBuffering:new B(!1),IsNotFullScreen:new B},subscribed_blocs:["HideToolBarBloc","ProgressBarBloc","IsVideoBuffering","VideoPlayerInView","VideoPlayControl"]}),this.playVideo=e=>{this.VideoPlayControl.play()},this.pauseVideo=e=>{this.VideoPlayControl.pause()},this.toggleFullScreen=e=>{var t;document.fullscreenElement?(this.getBloc("IsNotFullScreen").setTrue(),document.exitFullscreen(),setTimeout((()=>{screen.orientation.lock("portrait")}),100)):(this.getBloc("IsNotFullScreen").setFalse(),null===(t=this.shadowRoot.querySelector(".cont"))||void 0===t||t.requestFullscreen(),setTimeout((()=>{screen.orientation.lock("landscape")}),100))},this.isBuffering=e=>{this.IsVideoBuffering.setTrue()},this.isPlaying=e=>{this.IsVideoBuffering.setFalse()},this.metaDataAvailable=e=>{this.ProgressBarBloc.max=this.VideoPlayControl.video.duration},this.followVideoTime=e=>{this.ProgressBarBloc.update(this.VideoPlayControl.video.currentTime)}}convertSubscribedStatesToReactiveState(e){if(e)return{hideToolBar:e.HideToolBarBloc,progress_percent:e.ProgressBarBloc,playerInView:e.VideoPlayerInView,play:e.VideoPlayControl,timings:{total:g.covertToPlayTime(this.ProgressBarBloc.max),elapsed:g.covertToPlayTime(this.ProgressBarBloc.state*this.ProgressBarBloc.max/100)},isBuffering:e.IsVideoBuffering,isNotFullScreen:e.IsNotFullScreen}}get VideoPlayerInView(){return this._VideoPlayerInView||(this._VideoPlayerInView=this.getBloc("VideoPlayerInView")),this._VideoPlayerInView}get ProgressBarBloc(){return this._ProgressBarBloc||(this._ProgressBarBloc=this.getBloc("ProgressBarBloc")),this._ProgressBarBloc}get VideoPlayControl(){var e;return this._VideoPlayControl||(this._VideoPlayControl=this.getBloc("VideoPlayControl"),this._VideoPlayControl.video=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector(".video")),this._VideoPlayControl}connectedCallback(){super.connectedCallback(),setTimeout((()=>{var e;this.progressBarCont=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector(".progress-bar-cont");let t=this.VideoPlayControl.play();void 0!==t&&t.then((e=>{let t=new IntersectionObserver((e=>{e.forEach((e=>{var t,i;e.intersectionRatio<v.PLAYER_INTERSECTION_RATIO_FOR_PAUSE&&this.VideoPlayControl.isPlaying()?(this.VideoPlayControl.pause(),null===(t=this.VideoPlayerInView)||void 0===t||t.emit(!1)):e.intersectionRatio>=v.PLAYER_INTERSECTION_RATIO_FOR_PLAY&&this.VideoPlayControl.isNotPlaying()&&(this.hasAttribute("noautoplay")||this.VideoPlayControl.play(),null===(i=this.VideoPlayerInView)||void 0===i||i.emit(!0))}))}),{threshold:[0,1]});t.observe(this.VideoPlayControl.video)}))}),100)}build(e){let t=this.getAttribute("src");if(!t||!e)return r;let i=this.getAttribute("poster");return i||(i=void 0),o`<style>.cont{width:100%;height:100%}.video{width:var(--video-width,100%);height:var(--video-height,100%);background-color:var(--video-bg-color,#0000008a)}.seek-bar-cont{position:absolute;bottom:0;display:${e.hideToolBar?"none":"flex"};width:100%;height:80px;justify-content:flex-end;align-items:center;flex-direction:column;box-sizing:border-box;padding:5px 20px;left:0}.progress-bar-cont{background-color:#fff;min-height:5px;width:100%;position:relative;box-shadow:0 2px 3px #00000026}.progress{background-color:var(--theme-color,#ffcc00ff);position:absolute;left:0;height:5px;width:${e.progress_percent}}.total_time{color:#fff}.progress-stat{width:100%}.fullscreen{min-width:50px}.pauseIndicator{width:100%;height:100%}.buffering{top:25px;right:25px}</style><div class="cont"><lay-them in="stack"><video class="video" @click="${this.pauseVideo}" poster="${l(i)}" src="${t}" preload="none" @timeupdate="${this.followVideoTime}" @loadedmetadata="${this.metaDataAvailable}" @waiting="${this.isBuffering}" @playing="${this.isPlaying}"></video><ut-pan-zoom-detector bloc="ZoomAndPanBloc" .blocBuilderConfig="${this.zapBlocBuilderConfig}"><div class="seek-bar-cont"><div class="progress-bar-cont"><div class="progress"></div></div><div class="progress-stat"><lay-them in="row" ma="space-between"><div class="current_time">${e.timings.elapsed}</div><div class="fullscreen" @click="${this.toggleFullScreen}"><ink-well>${e.isNotFullScreen?o`<ut-icon icon="fullscreen" use="icon_inactive:white;"></ut-icon>`:o`<ut-icon icon="fullscreen-exit" use="icon_inactive:white;"></ut-icon>`}</ink-well></div><div class="total_time">${e.timings.total}</div></lay-them></div></div></ut-pan-zoom-detector><div class="buffering">${e.isBuffering?o`<circular-progress-indicator use="primaryColor:white;"></circular-progress-indicator>`:r}</div>${e.play?r:o`${i?o`<div><img src="${i}" style="width:100%;height:100%"></div>`:r}<div><circular-icon-button @click="${this.playVideo}" use="icon:play-arrow;primaryColor: white;radius: 50px;" style="--bg-color:#00000085"></circular-icon-button></div>`}</lay-them></div>`}get IsVideoBuffering(){return this._IsVideoBuffering||(this._IsVideoBuffering=this.getBloc("IsVideoBuffering")),this._IsVideoBuffering}get zapBlocBuilderConfig(){if(!this._zapBlocBuilderConfig){let e=this;this._zapBlocBuilderConfig={blocs_map:{ZoomAndPanBloc:new class extends De{constructor(){super(0),this.onZoom=(t,i)=>{e.VideoPlayControl.video.volume=t>1.8?1:t<.2?0:t},this.changeCurrentTimeTo=-1,this.onPan=(t,i)=>{this.hideToolBarTimer&&(clearTimeout(this.hideToolBarTimer),this.hideToolBarTimer=void 0);let s=e.progressBarCont.offsetWidth,o=100*t.x/s;if(e.ProgressBarBloc){let t=e.ProgressBarBloc.state+o;t<=0?t=0:t>=100&&(t=100),this.changeCurrentTimeTo=t*e.VideoPlayControl.video.duration/100,e.ProgressBarBloc.update(this.changeCurrentTimeTo)}},this._name="ZoomAndPanBloc"}onDoublePointTouch(e){}onPointRelease(t){this.changeCurrentTimeTo>=0&&(e.VideoPlayControl.video.currentTime=this.changeCurrentTimeTo,this.changeCurrentTimeTo=-1,e.VideoPlayControl.pause())}onPointTouch(e){}}}}}return this._zapBlocBuilderConfig}}customElements.define("ut-on-view-video",gt);class vt extends B{constructor(){super(!1)}get audio(){return this._audio}set audio(e){this._audio=e,this.audio.muted=!0}play(){this.emit(!0);let e=this.audio.play();return setTimeout((()=>{this.audio.muted=!1}),300),e}isPlaying(){return this.state}isNotPlaying(){return!this.state}pause(){this.emit(!1),this.audio.pause(),setTimeout((()=>{this.audio.muted=!0}),300)}onDisconnection(){this.audio&&(this.audio.pause(),this.audio.src="")}}customElements.define("ut-on-view-audio",class extends s{constructor(){super({blocs_map:{AudioPlayController:new vt,ProgressBarBloc:new mt({initState:0,max:100}),AudioPlayerBloc:new class extends t{constructor(){super(void 0),this._name="AudioPlayerBloc",this.onConnection=e=>{super.onConnection(e),setTimeout((()=>{var t;e.progressBarCont=null===(t=e.shadowRoot)||void 0===t?void 0:t.querySelector(".cont");let i=e.AudioPlayController.play();void 0!==i&&i.then((t=>{new IntersectionObserver((t=>{t.forEach((t=>{1!==t.intersectionRatio&&e.AudioPlayController.isPlaying()?e.AudioPlayController.pause():1===t.intersectionRatio&&e.AudioPlayController.isNotPlaying()&&(e.hasAttribute("noautoplay")||e.AudioPlayController.play())}))}),{threshold:[0,1]}).observe(e.progressBarCont)}))}),100)}}}},subscribed_blocs:["AudioPlayController","ProgressBarBloc"]}),this.followAudioTime=e=>{this.ProgressBarBloc.update(this.AudioPlayController.audio.currentTime)},this.metaDataAvailable=e=>{this.ProgressBarBloc.max=this.AudioPlayController.audio.duration},this.playAudio=e=>{this.AudioPlayController.play()},this.pauseAudio=e=>{this.AudioPlayController.pause()}}get zapBlocBuilderConfig(){if(!this._zapBlocBuilderConfig){let e=this;this._zapBlocBuilderConfig={blocs_map:{ZoomAndPanBloc:new class extends De{constructor(){super(0),this.onZoom=(t,i)=>{e.AudioPlayController.audio.volume=t>1.8?1:t<.2?0:t},this.changeCurrentTimeTo=-1,this.onPan=(t,i)=>{this.hideToolBarTimer&&(clearTimeout(this.hideToolBarTimer),this.hideToolBarTimer=void 0);let s=e.progressBarCont.offsetWidth,o=100*t.x/s;if(e.ProgressBarBloc){let t=e.ProgressBarBloc.state+o;t<=0?t=0:t>=100&&(t=100),this.changeCurrentTimeTo=t*e.AudioPlayController.audio.duration/100,e.ProgressBarBloc.update(this.changeCurrentTimeTo)}},this._name="ZoomAndPanBloc"}onDoublePointTouch(t){e.AudioPlayController.play()}onPointRelease(t){this.changeCurrentTimeTo>=0&&(e.AudioPlayController.audio.currentTime=this.changeCurrentTimeTo,this.changeCurrentTimeTo=-1,e.AudioPlayController.pause())}onPointTouch(t){e.AudioPlayController.pause()}}}}}return this._zapBlocBuilderConfig}convertSubscribedStatesToReactiveState(e){if(e)return{timings:{total:g.covertToPlayTime(this.ProgressBarBloc.max),elapsed:g.covertToPlayTime(this.ProgressBarBloc.state*this.ProgressBarBloc.max/100)},progress_percent:e.ProgressBarBloc,play:e.AudioPlayController}}build(e){let t=this.getAttribute("src");if(!t||!e)return r;let i=this.getAttribute("poster");return i||(i=void 0),o`<style>.cont{width:100%;height:100%}.seek-bar-cont{position:absolute;bottom:0;display:flex;width:100%;height:80px;justify-content:flex-end;align-items:center;flex-direction:column;box-sizing:border-box;padding:5px 20px;left:0}.progress-bar-cont{background-color:#fff;min-height:5px;width:100%;position:relative;box-shadow:0 2px 3px #00000026}.progress{background-color:var(--theme-color,#ffcc00ff);position:absolute;left:0;height:5px;width:${e.progress_percent}}.total_time{color:#fff}.progress-stat{width:100%}.fullscreen{min-width:50px}.cover,.full{width:100%;height:100%}</style><div class="cont"><lay-them in="stack">${i?o`<div class="cover" @click="${this.pauseAudio}"><img class="full" src="${i}"></div>`:o``}<audio class="audio" src="${t}" preload="none" @timeupdate="${this.followAudioTime}" @loadedmetadata="${this.metaDataAvailable}"></audio><ut-pan-zoom-detector bloc="ZoomAndPanBloc" .blocBuilderConfig="${this.zapBlocBuilderConfig}"><div class="seek-bar-cont"><div class="progress-bar-cont"><div class="progress"></div></div><div class="progress-stat"><lay-them in="row" ma="space-between"><div class="current_time">${e.timings.elapsed}</div><div class="total_time">${e.timings.total}</div></lay-them></div></div></ut-pan-zoom-detector><div class="pauseIndicator">${e.play?r:o`<circular-icon-button @click="${this.playAudio}" use="icon:play-arrow;primaryColor: white;radius: 50px;" style="--bg-color:#00000085"></circular-icon-button>`}</div></lay-them></div>`}get ProgressBarBloc(){return this._ProgressBarBloc||(this._ProgressBarBloc=this.getBloc("ProgressBarBloc")),this._ProgressBarBloc}get AudioPlayController(){var e;return this._AudioPlayController||(this._AudioPlayController=this.getBloc("AudioPlayController"),this._AudioPlayController.audio=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector(".audio")),this._AudioPlayController}});export{G as APage,b as ActionBloc,Te as AnimatedGradientBackground,j as AppPage,U as AppPageBloc,Y as AppPageContainer,W as AppPageController,vt as AudioPlayController,at as BackableScreen,f as BogusBloc,Qe as CheckBox,Ce as CircularCounterBloc,ke as CircularIconButton,ee as CircularProgressIndicator,p as ColorUtil,m as Compass,Ze as ConfirmationDialogue,Ye as CreateSearchableSelector,Je as DatePicker,T as Dialogue,ge as Expanded,I as FilePickerBloc,N as FilePickerExternalTriggers,z as FilePickerScreen,C as FilePickerType,_e as FormBloc,ye as FormBlocProvider,be as FormInputBuilder,it as FormInputMaker,ve as FormMessageBloc,S as GESTURE,ut as GenerateVerticalTabs,Pe as GestureDetector,Ie as GestureDetectorBloc,$e as GestureDetectorBuilder,B as HideBloc,Re as HorizontalScrollLimitDetector,re as I18NBloc,ae as I18NBlocProvider,D as IEDrawPurpose,R as IEMessageType,Ee as ImageBackground,$ as ImageConfirmationToolBoxContainer,st as ImageEditorHideBloc,Ve as InkWell,we as LabeledIconButton,u as LayThem,fe as MessageBuilder,w as NoBlocNoStateWidget,Be as NoBlocRaisedButton,x as NoBlocWidgetBuilder,gt as OnViewPlayVideo,mt as PercentageBloc,P as PickedFileWidget,J as ProgressBarBuilder,K as ProgressBarWidget,Q as ProgressBloc,nt as QrCodeListenerBloc,Xe as RadioButtonsBuilder,xe as RaisedButton,et as RangeSelector,H as RouteThem,F as RouteThemBloc,V as RouteThemController,L as RouteThemNavigationHookBloc,se as ScaffoldBloc,oe as ScaffoldBuilder,Ue as SelectorBloc,We as SelectorWidget,je as SelectorWidgetGrid,He as SingleLineInput,ct as SmartTabsBloc,dt as SmartTabsBuilder,E as SnackBarBloc,Fe as Tab,ze as TabController,Ne as TabHeader,Le as Tabs,Ge as TextAreaInput,q as Theme,Z as ThemeBloc,X as ThemeProvider,tt as ToggleButton,v as UseThemConfiguration,qe as UtIcon,k as UtRegistryBloc,pe as UtTextFree,ce as UtTextH1,he as UtTextH2,de as UtTextH3,ue as UtTextH5,me as UtTextH6,le as UtTextP,g as Utils,Oe as VerticalScrollLimitDetector,y as WidgetBuilder,De as ZoomAndPanBloc,ne as _I18NText};
