class e{}var I,E;e.PRESS_VIB=40,e.DRAG_VIB=30,e.IMAGE_EDIT_MID_RANGE=100,e.IMAGE_EDIT_ZOOM_SENSITIVITY=.05,e.IMAGE_EDIT_ZOOM_RESPONSE_TIME=200,e.IMAGE_EDIT_OP_DEFAULT_SIZE=800,e.PinchZoomBlocDoubleTapTime=500,e.IMAGE_RESIZE_SIZE_FILE_PICKER=1e3,e.IMAGE_RESIZE_QUALITY_FILE_PICKER=.8,e.PLAYER_INTERSECTION_RATIO_FOR_PLAY=1,e.PLAYER_INTERSECTION_RATIO_FOR_PAUSE=1,function(e){e[e.INIT=0]="INIT",e[e.NEW_IMAGE=1]="NEW_IMAGE",e[e.DRAW=2]="DRAW",e[e.GIVE_IMAGE=3]="GIVE_IMAGE"}(I||(I={})),function(e){e[e.NEW_IMAGE=0]="NEW_IMAGE",e[e.ZOOM=1]="ZOOM",e[e.PAN=2]="PAN",e[e.BRIGHTNESS=3]="BRIGHTNESS",e[e.CONTRAST=4]="CONTRAST"}(E||(E={}));const t=self;let o,_,a,n,A,M;const T={x:0,y:0};let i={x:0,y:0},s={x:0,y:0};async function c(c){switch(c.type){case I.INIT:{_=c.value;let e=_.getContext("2d");e&&(a=e)}break;case I.NEW_IMAGE:A=new Promise((async e=>{let I=c.value;I.newImageConfig?(o=I.newImageConfig,n=await createImageBitmap(o.origBlob),function(){let e=0,I=0;const E=o.opMaxLength,t=o.opMaxLength;e=n.width,I=n.height,e>E&&e>=I&&(I=~~(I*=E/e),e=E);I>=t&&(e=~~(e*=t/I),I=t);T.x=e,T.y=I,i={x:e,y:I},s={x:Math.floor((_.width-T.x)/2),y:Math.floor((_.height-T.y)/2)}}(),e(!0)):e(!1)}));case I.DRAW:A&&await A&&function(I){s={x:s.x+I.movement.x,y:s.y+I.movement.y},a.filter=`brightness(${I.brightness+100}%) contrast(${100+I.contrast}%)`,a.clearRect(0,0,o.opMaxLength,o.opMaxLength);const t=i.x*I.zoom,_=i.y*I.zoom;a.drawImage(n,0,0,n.width,n.height,s.x,s.y,t,_),M&&(clearTimeout(M),M=void 0);I.draw_purpose===E.ZOOM&&(M=setTimeout((()=>{i={x:t,y:_}}),e.IMAGE_EDIT_ZOOM_RESPONSE_TIME))}(c.value);break;case I.GIVE_IMAGE:{const e=await _.convertToBlob({type:"image/webp",quality:1});t.postMessage({blob:e})}}}t.onmessage=e=>{c(e.data)};
